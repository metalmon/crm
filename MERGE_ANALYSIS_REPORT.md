# –û—Ç—á–µ—Ç –ø–æ –∞–Ω–∞–ª–∏–∑—É —Å–ª–∏—è–Ω–∏—è —Å –≤–µ—Ç–∫–æ–π frappe/main

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-01-XX  
**–¢–µ–∫—É—â–∞—è –≤–µ—Ç–∫–∞:** `develop` (upstream/develop)  
**–¶–µ–ª–µ–≤–∞—è –≤–µ—Ç–∫–∞:** `frappe/main`  
**–ö–æ–º–º–∏—Ç –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–µ:** `37f7ee48` (refactor: update Avito message handling)  
**–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç –≤ frappe/main:** `ec4d7a8e` (chore(release): Bumped to Version 1.56.4)

---

## üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ - –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø –°–õ–ò–Ø–ù–ò–Ø

**üìã –°–º. –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω:** [`MERGE_STRATEGY.md`](./MERGE_STRATEGY.md)

**üéØ –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:**

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (—Å–æ–∑–¥–∞—Ç—å backup):**
   ```bash
   ./merge-prepare.sh
   ```

2. **–í—ã–ø–æ–ª–Ω–∏—Ç—å –º–µ—Ä–∂:**
   ```bash
   git checkout -b merge-frappe-main develop
   git merge frappe/main --no-commit --no-ff
   ```

3. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ–∞–π–ª—ã:**
   ```bash
   ./merge-restore.sh category_a
   ```

4. **–í—Ä—É—á–Ω—É—é –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é B** (hooks.py, doc.py, App.vue) - —Å–º. –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω

5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å:**
   ```bash
   ./merge-verify.sh
   git commit -m "merge: merge frappe/main with custom features"
   ```

**üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ñ–∞–π–ª–æ–≤:**
- üü¢ **–ö–∞—Ç–µ–≥–æ—Ä–∏—è A:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—à–∏ ‚Üí –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup
- üü° **–ö–∞—Ç–µ–≥–æ—Ä–∏—è B:** –ù–∞—à–∏ + –∏—Ö ‚Üí —Ä—É—á–Ω–æ–µ —Å–ª–∏—è–Ω–∏–µ
- üîµ **–ö–∞—Ç–µ–≥–æ—Ä–∏—è C:** –ò—Ö + –Ω–∞—à–∏ –º–µ—Å—Ç–∞ ‚Üí –ø—Ä–∏–Ω—è—Ç—å + –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
- üî¥ **–ö–∞—Ç–µ–≥–æ—Ä–∏—è D:** –ü–µ—Ä–µ–≤–æ–¥—ã ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—à–∏ (ru.csv, ru.po –±–æ–ª–µ–µ –ø–æ–ª–Ω—ã–µ!)
- üü¢ **–ö–∞—Ç–µ–≥–æ—Ä–∏—è E:** –ò—Ö ‚Üí –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø—Ä–∏–Ω—è—Ç—å

**üìù –ü–æ–ª–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:** –°–º. —Ä–∞–∑–¥–µ–ª ["–ü–†–ê–ö–¢–ò–ß–ï–°–ö–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø –°–õ–ò–Ø–ù–ò–Ø –° –ö–ê–¢–ï–ì–û–†–ò–ó–ê–¶–ò–ï–ô –§–ê–ô–õ–û–í"](#-–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-—Å–ª–∏—è–Ω–∏—è-—Å-–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–µ–π-—Ñ–∞–π–ª–æ–≤) –Ω–∏–∂–µ.

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–ö–æ–º–º–∏—Ç–æ–≤ –≤ frappe/main —Å 2024 –≥–æ–¥–∞:** ~3,578
- **–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:** 469
- **–°—Ç—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–æ:** 99,551
- **–°—Ç—Ä–æ–∫ —É–¥–∞–ª–µ–Ω–æ:** 56,967
- **–§–∞–π–ª–æ–≤ —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º–∏:** 243 (–≤ API –∏ frontend)

### –í–∞–∂–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–µ:** 1 –∫–æ–º–º–∏—Ç (Avito —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥)
- **–ö–æ–º–º–∏—Ç–æ–≤ –≤ frappe/main, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ:** ~100+ (–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- **–û–±—â–∏–π –ø—Ä–µ–¥–æ–∫:** –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–≤–µ—Ç–∫–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑–æ—à–ª–∏—Å—å)

---

## üö® –ì–õ–ê–í–ù–ê–Ø –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –≠–õ–ï–ú–ï–ù–¢–û–í –î–õ–Ø –°–û–•–†–ê–ù–ï–ù–ò–Ø

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –≠–ª–µ–º–µ–Ω—Ç | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|-----------|---------|-------------|--------|-----------|
| **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** | Avito –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–ø–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞) | üî¥ –ö–†–ò–¢–ò–ß–ù–û | ‚ùå –£–¥–∞–ª–µ–Ω–æ –≤ frappe/main | **1 - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** |
| **–û–Ω–±–æ–∞—Ä–¥–∏–Ω–≥** | –ö–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥ (`custom-ui/onboarding`) | üî¥ –ö–†–ò–¢–ò–ß–ù–û | ‚ùå –£–¥–∞–ª–µ–Ω–æ –≤ frappe/main | **1 - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** |
| **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞** | `crm/permissions.py` (—Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤) | üî¥ –ö–†–ò–¢–ò–ß–ù–û | ‚ùå –£–¥–∞–ª–µ–Ω–æ –≤ frappe/main | **1 - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** |
| **Hooks** | `permission_query_conditions` –≤ hooks.py | üî¥ –ö–†–ò–¢–ò–ß–ù–û | ‚ùå –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã | **1 - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** |
| **Hooks** | `doc_events` –¥–ª—è CRM Lead/Deal/Task | üî¥ –ö–†–ò–¢–ò–ß–ù–û | ‚ùå –£–¥–∞–ª–µ–Ω—ã | **1 - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** |
| **Hooks** | `doc_events` –¥–ª—è Avito Message | üî¥ –ö–†–ò–¢–ò–ß–ù–û | ‚ùå –£–¥–∞–ª–µ–Ω—ã | **1 - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** |
| **Hooks** | `scheduler_events` –¥–ª—è update_email_references | üî¥ –ö–†–ò–¢–ò–ß–ù–û | ‚ùå –£–¥–∞–ª–µ–Ω | **1 - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** |
| **API** | `crm/api/performance.py` | üü° –í–ê–ñ–ï–ù | ‚ùå –£–¥–∞–ª–µ–Ω | **2 - –°–û–•–†–ê–ù–ò–¢–¨** |
| **API** | `crm/api/system.py` | üü° –í–ê–ñ–ï–ù | ‚ùå –£–¥–∞–ª–µ–Ω | **2 - –°–û–•–†–ê–ù–ò–¢–¨** |
| **API** | `crm/api/cache_status.py` | üü° –í–ê–ñ–ï–ù | ‚ùå –£–¥–∞–ª–µ–Ω | **2 - –°–û–•–†–ê–ù–ò–¢–¨** |
| **API** | `crm/api/communication.py` | üü° –í–ê–ñ–ï–ù | ‚ùå –£–¥–∞–ª–µ–Ω | **2 - –°–û–•–†–ê–ù–ò–¢–¨** |
| **API** | `crm/api/address.py` | üü¢ –°–†–ï–î–ù–ò–ô | ‚ùå –£–¥–∞–ª–µ–Ω | **3 - –ü–†–û–í–ï–†–ò–¢–¨** |
| **API** | `crm/api/assignment.py` | üü¢ –°–†–ï–î–ù–ò–ô | ‚ùå –£–¥–∞–ª–µ–Ω | **3 - –ü–†–û–í–ï–†–ò–¢–¨** |
| **API** | `crm/api/telephony.py` | üü¢ –°–†–ï–î–ù–ò–ô | ‚ùå –£–¥–∞–ª–µ–Ω | **3 - –ü–†–û–í–ï–†–ò–¢–¨** |
| **DocTypes** | `CRM Funnel` | üü° –í–ê–ñ–ï–ù | ‚ùå –£–¥–∞–ª–µ–Ω | **2 - –°–û–•–†–ê–ù–ò–¢–¨** |
| **DocTypes** | `Sales Funnel Report Document` | üü° –í–ê–ñ–ï–ù | ‚ùå –£–¥–∞–ª–µ–Ω | **2 - –°–û–•–†–ê–ù–ò–¢–¨** |
| **Reports** | `Sales Funnel Conversion` | üü° –í–ê–ñ–ï–ù | ‚ùå –£–¥–∞–ª–µ–Ω | **2 - –°–û–•–†–ê–ù–ò–¢–¨** |
| **Frontend** | `SingleImageUploader.vue` | üü° –í–ê–ñ–ï–ù | ‚ùå –£–¥–∞–ª–µ–Ω | **2 - –°–û–•–†–ê–ù–ò–¢–¨** |
| **Frontend** | `App.vue` (Redis warmup –ª–æ–≥–∏–∫–∞) | üî¥ –ö–†–ò–¢–ò–ß–ù–û | ‚ùå –£–¥–∞–ª–µ–Ω–æ –≤ frappe/main | **1 - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** |
| **Frontend** | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞ | üî¥ –ö–†–ò–¢–ò–ß–ù–û | ‚ö†Ô∏è –ú–æ–≥—É—Ç –±—ã—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã | **1 - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** |
| **–ü–µ—Ä–µ–≤–æ–¥—ã** | `crm/translations/ru.csv` (457 —Å—Ç—Ä–æ–∫) | üî¥ –ö–†–ò–¢–ò–ß–ù–û | ‚ö†Ô∏è –í frappe/main –º–µ–Ω—å—à–µ —Å—Ç—Ä–æ–∫ | **1 - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** |
| **–ü–µ—Ä–µ–≤–æ–¥—ã** | `crm/locale/ru.po` (–ø–æ–ª–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã) | üî¥ –ö–†–ò–¢–ò–ß–ù–û | ‚ö†Ô∏è –ë–æ–ª—å—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (6088 —Å—Ç—Ä–æ–∫) | **1 - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** |
| **–ü–µ—Ä–µ–≤–æ–¥—ã** | –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —Å—Ç–∞—Ç—É—Å–æ–≤ | üü° –í–ê–ñ–ï–ù | ‚ö†Ô∏è –ú–æ–≥—É—Ç –±—ã—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã | **2 - –°–û–•–†–ê–ù–ò–¢–¨** |

**–õ–µ–≥–µ–Ω–¥–∞:**
- üî¥ **–ö–†–ò–¢–ò–ß–ù–û** - —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ —ç—Ç–æ–≥–æ
- üü° **–í–ê–ñ–ï–ù** - –≤–∞–∂–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω–∞
- üü¢ **–°–†–ï–î–ù–ò–ô** - –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ö–û–ù–§–õ–ò–ö–¢–´ –ò –†–ê–ó–õ–ò–ß–ò–Ø

### 1. üî¥ Avito –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–ö–†–ò–¢–ò–ß–ù–û)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Avito –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ `frappe/main`

**–î–µ—Ç–∞–ª–∏:**
- ‚úÖ **–í –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ:** –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Avito —Å API (`crm/api/avito.py`), —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –∏ DocType
- ‚ùå **–í frappe/main:** –í—Å–µ —Ñ–∞–π–ª—ã Avito **—É–¥–∞–ª–µ–Ω—ã**
  - `crm/api/avito.py` - —É–¥–∞–ª–µ–Ω
  - `frontend/src/components/Activities/AvitoArea.vue` - —É–¥–∞–ª–µ–Ω
  - `frontend/src/components/Activities/AvitoBox.vue` - —É–¥–∞–ª–µ–Ω
  - `frontend/src/components/Icons/AvitoIcon.vue` - —É–¥–∞–ª–µ–Ω
  - `frontend/src/composables/avito.js` - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- ‚ùå –ü—Ä–∏ —Å–ª–∏—è–Ω–∏–∏ –≤—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Avito –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω–∞
- ‚ùå –ù—É–∂–Ω–æ –±—É–¥–µ—Ç –≤—Ä—É—á–Ω—É—é —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã Avito –ø–µ—Ä–µ–¥ –º–µ—Ä–∂–µ–º
- ‚ùå –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –ø–æ–≤–µ—Ä—Ö –Ω–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**
```
crm/api/avito.py (D - —É–¥–∞–ª–µ–Ω –≤ frappe/main)
crm/hooks.py (—Å–æ–¥–µ—Ä–∂–∏—Ç hooks –¥–ª—è Avito Message)
frontend/src/components/Activities/Activities.vue (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç AvitoArea)
frontend/src/components/Activities/ActivityHeader.vue
frontend/src/pages/Lead.vue (–≤–∫–ª–∞–¥–∫–∞ Avito)
frontend/src/pages/Deal.vue (–≤–∫–ª–∞–¥–∫–∞ Avito)
frontend/src/pages/MobileLead.vue
frontend/src/components/Settings/Settings.vue (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Avito)
frontend/src/components/Settings/AvitoSettings.vue
frontend/src/composables/avito.js
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—Ç—å backup –≤—Å–µ—Ö Avito —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–¥ –º–µ—Ä–∂–µ–º**
2. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é
3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ Avito –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
4. ‚ö†Ô∏è –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ hooks –≤ `crm/hooks.py` –¥–ª—è Avito Message —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã

---

### 2. üü° –ö–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥ (–í–ê–ñ–ù–û)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ `frappe/main`

**–î–µ—Ç–∞–ª–∏:**
- ‚úÖ **–í –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ:** –ö–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥ (`frontend/src/components/custom-ui/onboarding/`)
- ‚ùå **–í frappe/main:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥ –∏–∑ `frappe-ui/frappe`

**–¢–µ–∫—É—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ:**
- ‚úÖ –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç: `import { useOnboarding } from '@/components/custom-ui/onboarding/onboarding'`
- ‚ö†Ô∏è **2 —Ñ–∞–π–ª–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π (–ù–ï–°–û–ì–õ–ê–°–û–í–ê–ù–ù–û–°–¢–¨):**
  - `frontend/src/components/Settings/InviteUserPage.vue` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `frappe-ui/frappe`
  - `frontend/src/components/Modals/ChangePasswordModal.vue` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `frappe-ui/frappe`

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**
```
frontend/src/components/custom-ui/onboarding/onboarding.js (–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ frappe/main)
frontend/src/components/custom-ui/onboarding/OnboardingSteps.vue
frontend/src/components/custom-ui/onboarding/GettingStartedBanner.vue
frontend/src/components/custom-ui/onboarding/HelpModal.vue
frontend/src/pages/Deal.vue
frontend/src/components/Layouts/AppSidebar.vue
frontend/src/components/Modals/NoteModal.vue
frontend/src/components/Modals/TaskModal.vue
frontend/src/components/Modals/ConvertToDealModal.vue
frontend/src/components/Modals/LeadModal.vue
frontend/src/components/CommunicationArea.vue
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥ –ø–µ—Ä–µ–¥ –º–µ—Ä–∂–µ–º
2. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞
3. üîß **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å** - –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ 2 —Ñ–∞–π–ª–∞ –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥:
   - `InviteUserPage.vue`
   - `ChangePasswordModal.vue`
4. ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞ —Å –Ω–æ–≤—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

---

### 3. üü¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è /crm (–í–ê–ñ–ù–û - –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

**–ü—Ä–æ–±–ª–µ–º–∞:** –í `frappe/main` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –≤ `crm/www/crm.py`

**–î–µ—Ç–∞–ª–∏:**

**–í frappe/main (`crm/www/crm.py`):**
```python
def get_context():
    from crm.api import check_app_permission

    if not check_app_permission():
        frappe.throw(
            _("You do not have permission to access Frappe CRM"),
            frappe.PermissionError
        )
    # ...
```

**–í –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ **–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç**
- –ï—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è `get_app_version()` —Å –ª–æ–≥–∏–∫–æ–π —á—Ç–µ–Ω–∏—è version.json

**–§—É–Ω–∫—Ü–∏—è `check_app_permission()` –≤ `crm/api/__init__.py`:**
```python
def check_app_permission():
    if frappe.session.user == "Administrator":
        return True
    
    allowed_modules = get_modules_from_all_apps_for_user()
    allowed_modules = [x["module_name"] for x in allowed_modules]
    if "FCRM" not in allowed_modules:
        return False
    
    roles = frappe.get_roles()
    if any(role in ["System Manager", "Sales User", "Sales Manager", "Sales Master Manager"] for role in roles):
        return True
    
    return False
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚úÖ –ü—Ä–∏–Ω—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ frappe/main - —ç—Ç–æ –≤–∞–∂–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
2. üîß –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–æ–π `get_app_version()` –µ—Å–ª–∏ –æ–Ω–∞ –Ω—É–∂–Ω–∞
3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

### 3.1. ‚úÖ –õ–û–ö–ê–õ–¨–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –ü–†–ê–í –î–û–°–¢–£–ü–ê –õ–£–ß–®–ï! (–ö–†–ò–¢–ò–ß–ù–û –î–õ–Ø –°–û–•–†–ê–ù–ï–ù–ò–Ø)

**–í–ê–ñ–ù–û:** –£ –≤–∞—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ **–ü–†–ê–í–ò–õ–¨–ù–ê–Ø** —Å–∏—Å—Ç–µ–º–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞, –∫–æ—Ç–æ—Ä–æ–π **–ù–ï–¢** –≤ `frappe/main`!

**–í–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ª–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ç–∫–∞):**

–§–∞–π–ª `crm/permissions.py`:
- ‚úÖ **Sales Manager** –≤–∏–¥–∏—Ç **–í–°–ï** –ª–∏–¥—ã –∏ —Å–¥–µ–ª–∫–∏ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É = –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
- ‚úÖ **Sales User** –≤–∏–¥–∏—Ç **–¢–û–õ–¨–ö–û** —Å–≤–æ–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –ª–∏–¥—ã/—Å–¥–µ–ª–∫–∏ (–ø–æ `lead_owner`/`deal_owner`)
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ —á–µ—Ä–µ–∑ hooks –≤ `permission_query_conditions`

**–õ–æ–≥–∏–∫–∞ –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã:**
```python
# Sales Manager - –≤–∏–¥–∏—Ç –≤—Å–µ
if "Sales Manager" in frappe.get_roles(user):
    return ""  # –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

# Sales User - —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã
conditions = [f"`tab{doctype}`.{owner_field} = '{user}'"]
# + –¥–æ–∫—É–º–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ DocShare (–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ ToDo)
```

**–í frappe/main:**
- ‚ùå –§–∞–π–ª `crm/permissions.py` **–û–¢–°–£–¢–°–¢–í–£–ï–¢**
- ‚ùå `permission_query_conditions` –≤ hooks.py **–ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–ù–´**
- ‚ùå **–ù–ï–¢** –ª–æ–≥–∏–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –ø–æ —Ä–æ–ª—è–º
- ‚ö†Ô∏è –í—Å–µ Sales Users –≤–∏–¥—è—Ç –≤—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ Frappe –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)

**–ß—Ç–æ –µ—Å—Ç—å –≤ frappe/main –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ:**
- Assignment Rule (DocType) - —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è** –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ù–æ —ç—Ç–æ –ù–ï –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä, —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤

**–í–∞—à–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–æ–ª–µ–π:**
- –†–û–ü (—Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å) = `Sales Manager` ‚Üí –≤–∏–¥–∏—Ç –≤—Å—ë ‚úÖ
- –û–±—ã—á–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã = `Sales User` ‚Üí –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ ‚úÖ

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** —Ñ–∞–π–ª `crm/permissions.py` –ø—Ä–∏ –º–µ—Ä–∂–µ
2. üî¥ **–ù–ï –ü–†–ò–ù–ò–ú–ê–¢–¨** —É–¥–∞–ª–µ–Ω–∏–µ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –∏–∑ frappe/main
3. üî¥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ hooks –æ—Å—Ç–∞—é—Ç—Å—è –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º–∏:
   ```python
   permission_query_conditions = {
       "CRM Deal": "crm.permissions.get_permission_query_conditions_for_crm_deal",
       "CRM Lead": "crm.permissions.get_permission_query_conditions_for_crm_lead",
       "CRM Task": "crm.permissions.get_permission_query_conditions_for_crm_task"
   }
   ```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚úÖ **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å** –≤—Å—é –ª–æ–≥–∏–∫—É –∏–∑ `crm/permissions.py`
2. ‚úÖ **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å** hooks –≤ `crm/hooks.py`
3. ‚úÖ –ü—Ä–∏ –º–µ—Ä–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é `-Xours` –¥–ª—è —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞, –∏–ª–∏ –≤—Ä—É—á–Ω—É—é –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
4. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞ - —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ Sales User –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã

---

### 4. üî¥ –£–¥–∞–ª–µ–Ω–Ω—ã–µ API —Ñ–∞–π–ª—ã - –í–°–ï –í–ê–®–ò –ö–ê–°–¢–û–ú–ù–´–ï! (–ö–†–ò–¢–ò–ß–ù–û)

**–í–ê–ñ–ù–û:** –í—Å–µ —É–¥–∞–ª–µ–Ω–Ω—ã–µ API —Ñ–∞–π–ª—ã –≤ `frappe/main` - —ç—Ç–æ **–í–ê–®–ò –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**! –û–Ω–∏ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã.

#### 4.1. üü¢ `crm/api/performance.py` - –í–ê–® –§–ê–ô–õ (–ö–†–ò–¢–ò–ß–ï–ù)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ API –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- `track_performance(f)` - –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ API –º–µ—Ç–æ–¥–æ–≤
- `check_system_performance()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –∏ —Ç—Ä–∏–≥–≥–µ—Ä –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—ç—à–∞
- `should_check_cache()` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—ç—à–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫
- `PerformanceMetrics` - –∫–ª–∞—Å—Å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫ –≤ –æ–∫–Ω–µ –≤—Ä–µ–º–µ–Ω–∏

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ `crm/api/system.py` - –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@track_performance` –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è—Ö
- ‚úÖ `crm/api/doc.py` - –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@track_performance` –Ω–∞ API –º–µ—Ç–æ–¥–∞—Ö
- ‚úÖ `crm/api/cache_status.py` - –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `check_system_performance`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - —ç—Ç–æ –≤–∞—à–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
2. ‚úÖ –§–∞–π–ª –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã
3. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç

---

#### 4.2. üü¢ `crm/api/system.py` - –í–ê–® –§–ê–ô–õ (–ö–†–ò–¢–ò–ß–ï–ù)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- `get_redis_cache_status()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Redis –∫—ç—à–∞ –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
- `check_database()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- `check_websocket()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ WebSocket —Å–µ—Ä–≤–µ—Ä–∞
- `check_background_workers()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ–Ω–æ–≤—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
- `ensure_doctypes_loaded()` - –ø—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞ DocTypes
- `cleanup_temp_tables()` - –æ—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
- `warm_up_cache()` - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞
- –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (progress %)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ **`frontend/src/App.vue`** - –ö–†–ò–¢–ò–ß–ù–û! –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã:
  ```javascript
  url: 'crm.api.system.get_redis_cache_status'
  ```
- ‚úÖ `crm/api/performance.py` - –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `get_redis_cache_status`
- ‚úÖ `crm/api/cache_status.py` - –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `get_redis_cache_status`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ App.vue –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
2. ‚úÖ –≠—Ç–æ –∫–ª—é—á–µ–≤–∞—è —á–∞—Å—Ç—å –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
3. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ App.vue –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

---

#### 4.3. üü¢ `crm/api/cache_status.py` - –í–ê–® –§–ê–ô–õ

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—ç—à–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- `check_background_workers()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ–Ω–æ–≤—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
- `should_check_cache()` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—ç—à–∞
- `check_system_performance()` - –æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ `crm/api/system.py` - –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `check_background_workers`
- ‚úÖ `crm/api/performance.py` - –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `check_system_performance`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - —á–∞—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

---

#### 4.4. üü¢ `crm/api/communication.py` - –í–ê–® –§–ê–ô–õ (–í–ê–ñ–ï–ù)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞–±–æ—Ç–∞ —Å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ email –∫ –ª–∏–¥–∞–º/—Å–¥–µ–ª–∫–∞–º

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- `track_communication()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π (—Ç–µ–ª–µ—Ñ–æ–Ω/whatsapp) —Å –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø—Ä–∞–≤
- `update_email_references()` - **–ö–†–ò–¢–ò–ß–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ email –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ —Å –ª–∏–¥–∞–º–∏/—Å–¥–µ–ª–∫–∞–º–∏ –ø–æ email –∞–¥—Ä–µ—Å–∞–º
- `create_indices()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- `fix_email_references()` - —Ä—É—á–Ω–æ–π —Ç—Ä–∏–≥–≥–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è email —Å—Å—ã–ª–æ–∫

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ **`crm/hooks.py`** - –≤ `scheduler_events`:
  ```python
  scheduler_events = {
      "hourly": [
          "crm.api.communication.update_email_references"  # –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å!
      ]
  }
  ```
- ‚úÖ **`crm/patches/v1_0/create_email_indices.py`** - –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `create_indices`
- ‚úÖ **`frontend/src/utils/communicationUtils.js`**:
  ```javascript
  url: 'crm.api.communication.track_communication'
  ```
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Lead.vue, Deal.vue, Contact.vue –∏ –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å —á–µ—Ä–µ–∑ scheduler
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç email –ø–∞–∫–µ—Ç–∞–º–∏ –ø–æ 50 —à—Ç—É–∫
- –°–≤—è–∑—ã–≤–∞–µ—Ç email —Å –ª–∏–¥–∞–º–∏/—Å–¥–µ–ª–∫–∞–º–∏ –ø–æ email –∞–¥—Ä–µ—Å–∞–º
- –°–æ–∑–¥–∞–µ—Ç –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - –∫—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å email
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ scheduler hook —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ hooks.py
3. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–∏–≤—è–∑–∫—É email

---

#### 4.5. üü¢ `crm/api/address.py` - –í–ê–® –§–ê–ô–õ

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞–±–æ—Ç–∞ —Å –∞–¥—Ä–µ—Å–∞–º–∏

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- `get_default_country()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–∑ System Settings (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 'Russian Federation' –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ **`frontend/src/components/Modals/AddressModal.vue`**:
  ```javascript
  url: 'crm.api.address.get_default_country'
  ```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ AddressModal
2. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É AddressModal

---

#### 4.6. üü¢ `crm/api/assignment.py` - –í–ê–® –§–ê–ô–õ (–í–ê–ñ–ï–ù)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –ª–æ–≥–∏–∫–æ–π retry –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è deadlock

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- `add_with_retry()` - –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å retry –ª–æ–≥–∏–∫–æ–π (3 –ø–æ–ø—ã—Ç–∫–∏) –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è deadlock
- `add_multiple_with_retry()` - –º–∞—Å—Å–æ–≤–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å retry
- `remove_with_retry()` - —Å–Ω—è—Ç–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Å retry –ª–æ–≥–∏–∫–æ–π

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ **`frontend/src/components/Modals/AssignmentModal.vue`**:
  ```javascript
  call('crm.api.assignment.add_with_retry', { ... })
  call('crm.api.assignment.add_multiple_with_retry', { ... })
  ```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í frappe/main –µ—Å—Ç—å `assignment_rule.py` - —ç—Ç–æ –¥—Ä—É–≥–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–ø—Ä–∞–≤–∏–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è), –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç retry –ª–æ–≥–∏–∫—É.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ AssignmentModal
2. ‚úÖ Retry –ª–æ–≥–∏–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è deadlock –ø—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è—Ö
3. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É AssignmentModal

---

#### 4.7. üü¢ `crm/api/telephony.py` - –í–ê–® –§–ê–ô–õ

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π —Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- `is_beeline_installed()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ app 'beeline' –≤ —Ç–µ–∫—É—â–µ–º bench

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ **`frontend/src/components/Settings/TelephonySettings.vue`**:
  ```javascript
  url: 'crm.api.telephony.is_beeline_installed'
  ```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ TelephonySettings
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω—É–∂–Ω–∞ –ª–∏ –≤–∞–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Beeline
3. ‚úÖ –ï—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–∞ - –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å, –Ω–æ –ª—É—á—à–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

---

## üìã –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –£–î–ê–õ–ï–ù–ù–´–• API –§–ê–ô–õ–û–í

| –§–∞–π–ª | –í–∞—à? | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ |
|------|------|-------------|---------------|----------|
| `performance.py` | ‚úÖ –î–ê | üî¥ –ö–†–ò–¢–ò–ß–ï–ù | system.py, doc.py, cache_status.py | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `system.py` | ‚úÖ –î–ê | üî¥ –ö–†–ò–¢–ò–ß–ï–ù | App.vue, performance.py | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `cache_status.py` | ‚úÖ –î–ê | üü° –í–ê–ñ–ï–ù | system.py, performance.py | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `communication.py` | ‚úÖ –î–ê | üî¥ –ö–†–ò–¢–ò–ß–ï–ù | hooks.py (scheduler), frontend | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `address.py` | ‚úÖ –î–ê | üü° –í–ê–ñ–ï–ù | AddressModal.vue | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `assignment.py` | ‚úÖ –î–ê | üü° –í–ê–ñ–ï–ù | AssignmentModal.vue | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `telephony.py` | ‚úÖ –î–ê | üü¢ –°–†–ï–î–ù–ò–ô | TelephonySettings.vue | **–°–û–•–†–ê–ù–ò–¢–¨** |

---

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ó–ê–í–ò–°–ò–ú–û–°–¢–ò

### –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏:

```
performance.py
  ‚îú‚îÄ‚Üí system.py (–∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç get_redis_cache_status)
  ‚îú‚îÄ‚Üí cache_status.py (–∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç check_system_performance)
  ‚îî‚îÄ‚Üí doc.py (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç @track_performance)

system.py
  ‚îú‚îÄ‚Üí performance.py (–∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç track_performance)
  ‚îî‚îÄ‚Üí cache_status.py (–∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç check_background_workers)

cache_status.py
  ‚îú‚îÄ‚Üí system.py (–∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç get_redis_cache_status)
  ‚îî‚îÄ‚Üí performance.py (–∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç check_system_performance)

communication.py
  ‚îî‚îÄ‚Üí hooks.py (scheduler_events - hourly)
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ frontend:

```
App.vue ‚Üí system.get_redis_cache_status()
AddressModal.vue ‚Üí address.get_default_country()
AssignmentModal.vue ‚Üí assignment.add_with_retry()
AssignmentModal.vue ‚Üí assignment.add_multiple_with_retry()
communicationUtils.js ‚Üí communication.track_communication()
TelephonySettings.vue ‚Üí telephony.is_beeline_installed()
```

---

## ‚úÖ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô –î–õ–Ø –£–î–ê–õ–ï–ù–ù–´–• API

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã (–î–û –º–µ—Ä–∂–∞)

1. ‚úÖ **–°–æ–∑–¥–∞—Ç—å backup –≤—Å–µ—Ö API —Ñ–∞–π–ª–æ–≤:**
   ```bash
   mkdir -p backup_api_files
   cp crm/api/performance.py backup_api_files/
   cp crm/api/system.py backup_api_files/
   cp crm/api/cache_status.py backup_api_files/
   cp crm/api/communication.py backup_api_files/
   cp crm/api/address.py backup_api_files/
   cp crm/api/assignment.py backup_api_files/
   cp crm/api/telephony.py backup_api_files/
   ```

2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å hooks:**
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `scheduler_events` —Å `update_email_references` —Å–æ—Ö—Ä–∞–Ω–µ–Ω

3. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã:**
   - –í—Å–µ —Ñ–∞–π–ª—ã –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∞–Ω—ã, –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –≤–º–µ—Å—Ç–µ

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞

4. üîß **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –∏–∑ backup**

5. üîß **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ hooks –ø–æ–¥–∫–ª—é—á–µ–Ω—ã
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ frontend –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å API

6. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:**
   - –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (App.vue)
   - Email references (scheduler)
   - Assignment modal
   - Address modal
   - Telephony settings

---

### 5. üî¥ –£–¥–∞–ª–µ–Ω–Ω—ã–µ DocTypes - –í–ê–®–ò –ö–ê–°–¢–û–ú–ù–´–ï! (–ö–†–ò–¢–ò–ß–ù–û)

**–í–ê–ñ–ù–û:** –í—Å–µ —É–¥–∞–ª–µ–Ω–Ω—ã–µ DocTypes —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å Sales Funnel - —ç—Ç–æ **–í–ê–®–ò –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**!

#### 5.1. üü¢ `CRM Funnel` - –í–ê–® DocType (–í–ê–ñ–ï–ù)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ –≤–æ—Ä–æ–Ω–æ–∫ –ø—Ä–æ–¥–∞–∂

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- –ü—Ä–æ—Å—Ç–æ–π DocType —Å –æ–¥–Ω–∏–º –ø–æ–ª–µ–º `sales_funnel` (Data)
- Permissions –¥–ª—è System Manager, Sales Manager, Sales User

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ **–°–≤—è–∑–∞–Ω —Å CRM Deal** —á–µ—Ä–µ–∑ –ø–æ–ª–µ `sales_funnel` (Link field, options: "CRM Funnel")
- ‚ö†Ô∏è –í CRM Lead –ø–æ–ª—è `sales_funnel` –Ω–µ—Ç (—Ç–æ–ª—å–∫–æ –≤ Deal)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Sales Funnel Conversion report
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Sales Funnel Report Document

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - —ç—Ç–æ –≤–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π DocType
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ CRM Deal/Lead
3. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–≤—è–∑–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

#### 5.2. üü¢ `Sales Funnel Report Document` - –í–ê–® DocType (–ö–†–ò–¢–ò–ß–ï–ù)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Virtual DocType –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤ –ø–æ –≤–æ—Ä–æ–Ω–∫–∞–º –ø—Ä–æ–¥–∞–∂

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- Virtual DocType (–Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ –ë–î, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã (Lead/Deal) –≤ –≤–æ—Ä–æ–Ω–∫–µ –ø—Ä–æ–¥–∞–∂
- –ü–æ–ª—è: document_type, document_name, display_name, furthest_stage_reached, current_status, total_touches –∏ –¥—Ä.
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å Sales Funnel Conversion report

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ `crm/fcrm/report/sales_funnel_conversion/sales_funnel_conversion.py` - –æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ç—á–µ—Ç
- ‚úÖ –ò–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π list view (`sales_funnel_report_document_list.js`)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–π –≤ –≤–æ—Ä–æ–Ω–∫–∞—Ö

**–ö–æ–¥:**
```python
# Virtual DocType —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–æ–π
class SalesFunnelReportDocument(Document):
    def load_from_db(self):
        # –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ CRM Lead/Deal –Ω–∞ –æ—Å–Ω–æ–≤–µ sales_funnel
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
2. ‚úÖ –≠—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ç—á–µ—Ç–æ–≤, –∫–æ—Ç–æ—Ä—É—é –≤—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª–∏
3. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É report

---

#### 5.3. üü¢ `Sales Funnel Conversion` (Report) - –í–ê–® –†–ï–ü–û–†–¢ (–ö–†–ò–¢–ò–ß–ï–ù)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç—á–µ—Ç –ø–æ –∫–æ–Ω–≤–µ—Ä—Å–∏—è–º –≤ –≤–æ—Ä–æ–Ω–∫–∞—Ö –ø—Ä–æ–¥–∞–∂

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –æ—Ç—á–µ—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤–æ—Ä–æ–Ω–æ–∫ –ø—Ä–æ–¥–∞–∂
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –º–µ–∂–¥—É —Å—Ç–∞–¥–∏—è–º–∏
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å Sales Funnel Report Document
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç Lead –∏ Deal –¥–æ–∫—É–º–µ–Ω—Ç—ã

**–§–∞–π–ª—ã:**
- `crm/fcrm/report/sales_funnel_conversion/sales_funnel_conversion.py` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥
- `crm/fcrm/report/sales_funnel_conversion/sales_funnel_conversion.js` - frontend
- `crm/fcrm/report/sales_funnel_conversion/sales_funnel_conversion.json` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ –û—Ç—á–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ Frappe UI
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–¥–∞–∂
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å Sales Funnel Report Document

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - –∫—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
2. ‚úÖ –≠—Ç–æ –≤–∞—à–∞ –∫–∞—Å—Ç–æ–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ç—á–µ—Ç–æ–≤
3. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É report

---

#### 5.4. üü° –î—Ä—É–≥–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã–µ DocTypes

**–£–¥–∞–ª–µ–Ω–Ω—ã–µ DocTypes:**
- `Twilio Agents` - —É–¥–∞–ª–µ–Ω (–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ `CRM Telephony Agent`?)
- `Twilio Settings` - —É–¥–∞–ª–µ–Ω (–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ `CRM Twilio Settings`?)

**–ù–æ–≤—ã–µ DocTypes –≤ frappe/main:**
- `CRM Rolling Response Time` - –¥–æ–±–∞–≤–ª–µ–Ω
- `Facebook Lead Form` - –¥–æ–±–∞–≤–ª–µ–Ω
- `Facebook Page` - –¥–æ–±–∞–≤–ª–µ–Ω
- `Failed Lead Sync Log` - –¥–æ–±–∞–≤–ª–µ–Ω
- `Lead Sync Source` - –¥–æ–±–∞–≤–ª–µ–Ω

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Twilio DocTypes - –≤–æ–∑–º–æ–∂–Ω–æ –æ–Ω–∏ –±—ã–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã
2. ‚úÖ –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ –Ω–æ–≤—ã–µ –∏–º–µ–Ω–∞
3. ‚úÖ –û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–æ–≤—ã–º–∏ DocTypes –∏ –∏—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é

---

## üìã –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –£–î–ê–õ–ï–ù–ù–´–• DOCTYPES

| DocType/Report | –í–∞—à? | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ |
|----------------|------|-------------|---------------|----------|
| `CRM Funnel` | ‚úÖ –î–ê | üü° –í–ê–ñ–ï–ù | CRM Deal/Lead, Reports | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `Sales Funnel Report Document` | ‚úÖ –î–ê | üî¥ –ö–†–ò–¢–ò–ß–ï–ù | Sales Funnel Conversion report | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `Sales Funnel Conversion` | ‚úÖ –î–ê | üî¥ –ö–†–ò–¢–ò–ß–ï–ù | Report –≤ Frappe UI | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `Twilio Agents` | ‚ùì | üü¢ –°–†–ï–î–ù–ò–ô | –í–æ–∑–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–µ–Ω | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `Twilio Settings` | ‚ùì | üü¢ –°–†–ï–î–ù–ò–ô | –í–æ–∑–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–µ–Ω | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |

---

## ‚úÖ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô –î–õ–Ø –£–î–ê–õ–ï–ù–ù–´–• DOCTYPES

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: Sales Funnel —Å–∏—Å—Ç–µ–º–∞ (–î–û –º–µ—Ä–∂–∞)

1. ‚úÖ **–°–æ–∑–¥–∞—Ç—å backup –≤—Å–µ—Ö Sales Funnel —Ñ–∞–π–ª–æ–≤:**
   ```bash
   mkdir -p backup_funnel_files
   cp -r crm/fcrm/doctype/crm_funnel backup_funnel_files/
   cp -r crm/fcrm/doctype/sales_funnel_report_document backup_funnel_files/
   cp -r crm/fcrm/report/sales_funnel_conversion backup_funnel_files/
   ```

2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤—è–∑–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ CRM Deal/Lead –∏–º–µ—é—Ç –ø–æ–ª–µ `sales_funnel`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ report —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞

3. üîß **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ Sales Funnel —Ñ–∞–π–ª—ã –∏–∑ backup**

4. üîß **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Virtual DocType —Ä–∞–±–æ—Ç–∞–µ—Ç
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ report –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤—è–∑–∏ —Å CRM Deal/Lead

5. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:**
   - Sales Funnel Conversion report
   - Sales Funnel Report Document list view
   - –°–≤—è–∑–∏ —Å –ª–∏–¥–∞–º–∏/—Å–¥–µ–ª–∫–∞–º–∏

---

### 6. üî¥ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ frontend - –í–ê–® –ö–û–ú–ü–û–ù–ï–ù–¢ –£–î–ê–õ–ï–ù!

#### 6.1. üü¢ `SingleImageUploader.vue` - –í–ê–® –ö–û–ú–ü–û–ù–ï–ù–¢ (–í–ê–ñ–ï–ù)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å drag & drop

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ó–∞–≥—Ä—É–∑–∫–∞ –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ drag & drop
- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–æ–≤ (PNG, JPG, GIF, SVG, BMP, WebP)
- –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FilesUploadHandler

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ **`frontend/src/components/FieldLayout/Field.vue`** - –¥–ª—è –ø–æ–ª—è —Ç–∏–ø–∞ "Attach Image":
  ```vue
  <SingleImageUploader 
      :image-url="tempImages[field.fieldname] || data[field.fieldname]"
      :doctype="doctype"
      :docname="data.name"  
      @upload="..."
      @remove="..."
      @select="..."
  />
  ```
- ‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `frontend/components.d.ts`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø–æ–ª—è—Ö —Å —Ç–∏–ø–æ–º "Attach Image" –≤ —Ñ–æ—Ä–º–∞—Ö

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ FieldLayout
2. ‚úÖ –≠—Ç–æ –≤–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
3. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø–æ–ª–µ–π —Å —Ç–∏–ø–æ–º "Attach Image"

---

---

## üìã –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –£–î–ê–õ–ï–ù–ù–´–• FRONTEND –ö–û–ú–ü–û–ù–ï–ù–¢–û–í

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í–∞—à? | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ |
|-----------|------|-------------|---------------|----------|
| `SingleImageUploader.vue` | ‚úÖ –î–ê | üü° –í–ê–ñ–ï–ù | FieldLayout/Field.vue | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `UserLink.vue` | ‚ùì | üü¢ –°–†–ï–î–ù–ò–ô | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `TimespanSelect.vue` | ‚ùì | üü¢ –°–†–ï–î–ù–ò–ô | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |
| `CountryLink.vue` | ‚ùì | üü¢ –°–†–ï–î–ù–ò–ô | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å |

---

#### 6.2. üü° –î—Ä—É–≥–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**–£–¥–∞–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `frontend/src/components/Controls/UserLink.vue` - —É–¥–∞–ª–µ–Ω
- `frontend/src/components/Controls/TimespanSelect.vue` - —É–¥–∞–ª–µ–Ω
- `frontend/src/components/Controls/CountryLink.vue` - —É–¥–∞–ª–µ–Ω

**–ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `frontend/src/components/ConditionsFilter/CFCondition.vue` - –¥–æ–±–∞–≤–ª–µ–Ω
- `frontend/src/components/ConditionsFilter/CFConditions.vue` - –¥–æ–±–∞–≤–ª–µ–Ω
- `frontend/src/components/ConditionsFilter/filterableFields.ts` - –¥–æ–±–∞–≤–ª–µ–Ω

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö:**
- `frontend/src/App.vue` - –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (272 —Å—Ç—Ä–æ–∫–∏ —É–¥–∞–ª–µ–Ω–æ)
- `frontend/src/components/Activities/Activities.vue` - 546 —Å—Ç—Ä–æ–∫ —É–¥–∞–ª–µ–Ω–æ
- `frontend/src/components/Filter.vue` - –∏–∑–º–µ–Ω–µ–Ω–∏—è

---

## ‚úÖ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô –î–õ–Ø –£–î–ê–õ–ï–ù–ù–´–• –ö–û–ú–ü–û–ù–ï–ù–¢–û–í

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: SingleImageUploader (–î–û –º–µ—Ä–∂–∞)

1. ‚úÖ **–°–æ–∑–¥–∞—Ç—å backup –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:**
   ```bash
   mkdir -p backup_frontend_components
   cp frontend/src/components/Controls/SingleImageUploader.vue backup_frontend_components/
   ```

2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Field.vue
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ components.d.ts

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞

3. üîß **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑ backup**

4. üîß **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–º–ø–æ—Ä—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

5. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:**
   - –ü–æ–ª—è —Å —Ç–∏–ø–æ–º "Attach Image" –≤ —Ñ–æ—Ä–º–∞—Ö
   - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   - Drag & drop —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
   - –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞
2. üîß –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (UserLink, TimespanSelect, CountryLink)
3. ‚úÖ –û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–æ–≤—ã–º ConditionsFilter

---

### 7. üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø –í HOOKS.PY (–ö–†–ò–¢–ò–ß–ù–û)

**–í–ê–ñ–ù–û:** –í `frappe/main` –ø—Ä–æ–∏–∑–æ—à–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `crm/hooks.py`, –∫–æ—Ç–æ—Ä—ã–µ —É–¥–∞–ª—è—é—Ç –≤–∞—à–∏ –≤–∞–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏!

#### 7.1. üî¥ permission_query_conditions - –£–î–ê–õ–ï–ù–´ (–ö–†–ò–¢–ò–ß–ù–û)

**–í –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ:**
```python
permission_query_conditions = {
    "CRM Deal": "crm.permissions.get_permission_query_conditions_for_crm_deal",
    "CRM Lead": "crm.permissions.get_permission_query_conditions_for_crm_lead",
    "CRM Task": "crm.permissions.get_permission_query_conditions_for_crm_task"
}
```

**–í frappe/main:**
- ‚ùå **–ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–ù–´** - –≤–µ—Å—å –±–ª–æ–∫ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- ‚ùå –í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ **–ù–ï –ë–£–î–ï–¢ –†–ê–ë–û–¢–ê–¢–¨**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∞–≤
2. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ hooks –∞–∫—Ç–∏–≤–Ω—ã

---

#### 7.2. üî¥ doc_events - –£–î–ê–õ–ï–ù–´ –í–ê–ñ–ù–´–ï HOOKS (–ö–†–ò–¢–ò–ß–ù–û)

**–í –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ:**
- ‚úÖ `CRM Lead`: hooks –¥–ª—è `on_update`, `after_insert`, `on_trash` ‚Üí `crm.api.doc.on_doc_update`
- ‚úÖ `CRM Deal`: hooks –¥–ª—è `on_update`, `after_insert`, `on_trash` ‚Üí `crm.api.doc.on_doc_update`
- ‚úÖ `CRM Task`: hooks –¥–ª—è `on_update`, `after_insert`, `on_trash` ‚Üí `crm.api.doc.on_doc_update`
- ‚úÖ `Avito Message`: hooks –¥–ª—è `validate`, `on_update`

**–í frappe/main:**
- ‚ùå **–£–î–ê–õ–ï–ù–´** hooks –¥–ª—è CRM Lead (on_update, after_insert, on_trash)
- ‚ùå **–£–î–ê–õ–ï–ù–´** hooks –¥–ª—è CRM Task (on_update, after_insert, on_trash)
- ‚ùå **–£–î–ê–õ–ï–ù–´** hooks –¥–ª—è CRM Deal (–æ—Å—Ç–∞–ª—Å—è —Ç–æ–ª—å–∫–æ on_update –¥–ª—è ERPNext)
- ‚ùå **–£–î–ê–õ–ï–ù–´** hooks –¥–ª—è Avito Message
- ‚ùå **–§–£–ù–ö–¶–ò–Ø `on_doc_update` –£–î–ê–õ–ï–ù–ê** –∏–∑ `crm/api/doc.py`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç `on_doc_update`:**
- –ü—É–±–ª–∏–∫—É–µ—Ç realtime —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ socket (`doc_update`) —Å –ø–æ–º–æ—â—å—é `frappe.publish_realtime()`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è: `created`, `modified`, `deleted`
- –ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏:
```python
def on_doc_update(doc, method=None):
    """Publish updates to subscribed clients"""
    if doc.doctype not in ['CRM Lead', 'CRM Deal', 'CRM Task']:
        return
    event = 'modified'
    if method == 'after_insert':
        event = 'created'
    elif method == 'on_trash':
        event = 'deleted'
    frappe.publish_realtime(
        'doc_update',
        {
            'doctype': doc.doctype,
            'name': doc.name,
            'data': {'event': event}
        },
        after_commit=True
    )
```

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ `frontend/src/socket.js` - **–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è `doc_update`** (–µ—Å—Ç—å –≤ –≤–∞—à–µ–π –≤–µ—Ä—Å–∏–∏!)
- ‚úÖ `frontend/src/components/Kanban/KanbanView.vue` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `subscribeToDoc()` –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏
- ‚úÖ `frontend/src/pages/Deal.vue`, `Lead.vue` - –∏—Å–ø–æ–ª—å–∑—É—é—Ç realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**–ü–†–û–ë–õ–ï–ú–ê:**
- ‚ö†Ô∏è Frontend –∫–æ–¥ **–£–ñ–ï –ì–û–¢–û–í** –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–æ–±—ã—Ç–∏—è `doc_update` (–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –µ—Å—Ç—å –≤ `socket.js`)
- ‚ö†Ô∏è –ù–æ –≤ `frappe/main` **–ù–ï–¢ backend –∫–æ–¥–∞**, –∫–æ—Ç–æ—Ä—ã–π –ø—É–±–ª–∏–∫—É–µ—Ç —ç—Ç–∏ —Å–æ–±—ã—Ç–∏—è
- ‚ö†Ô∏è –ë–µ–∑ `on_doc_update` —Ñ—É–Ω–∫—Ü–∏—è –∏ hooks - realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è **–ù–ï –ë–£–î–£–¢ –†–ê–ë–û–¢–ê–¢–¨**

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- ‚ùå –í `frappe/main:crm/api/doc.py` **–ù–ï–¢** —Ñ—É–Ω–∫—Ü–∏–∏ `on_doc_update`
- ‚ùå –í `frappe/main:crm/api/doc.py` **–ù–ï–¢** –≤—ã–∑–æ–≤–æ–≤ `frappe.publish_realtime()` –¥–ª—è `doc_update`
- ‚ùå –í `frappe/main` hooks –¥–ª—è realtime —Å–æ–±—ã—Ç–∏–π **–£–î–ê–õ–ï–ù–´**
- ‚úÖ **–í–´–í–û–î:** Realtime —Å–æ–±—ã—Ç–∏—è –¥–ª—è CRM Lead/Deal/Task **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–´** –≤ frappe/main
- ‚ö†Ô∏è **–í–´–í–û–î:** –≠—Ç–æ –≤–∞—à–∞ –∫–∞—Å—Ç–æ–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å!

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
2. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è `on_doc_update` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ `crm/api/doc.py`
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ hooks –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ `hooks.py`
4. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–æ—Ç–∫—Ä–æ–π—Ç–µ –¥–≤–∞ –æ–∫–Ω–∞ –∏ –æ–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç)
5. ‚ö†Ô∏è –ï—Å–ª–∏ realtime –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `on_doc_update` –∏ hooks

---

#### 7.3. üî¥ scheduler_events - –ó–ê–ú–ï–ù–ï–ù–´ (–í–ê–ñ–ù–û)

**–í –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ:**
```python
scheduler_events = {
    "hourly": [
        "crm.api.communication.update_email_references"  # –í–ê–®–ê –§–£–ù–ö–¶–ò–Ø
    ]
}
```

**–í frappe/main:**
```python
scheduler_events = {
    "daily_long": [
        "crm.lead_syncing.background_sync.sync_leads_from_sources_daily"
    ],
    "hourly_long": [
        "crm.lead_syncing.background_sync.sync_leads_from_sources_hourly"
    ],
    "monthly_long": [
        "crm.lead_syncing.background_sync.sync_leads_from_sources_monthly"
    ],
    "cron": {
        "*/5 * * * *": [
            "crm.lead_syncing.background_sync.sync_leads_from_sources_5_minutes"
        ],
        # ... –∏ —Ç.–¥.
    }
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå –í–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è `update_email_references` **–£–î–ê–õ–ï–ù–ê** –∏–∑ scheduler
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è lead_syncing (Facebook Lead Forms)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –í–û–°–°–¢–ê–ù–û–í–ò–¢–¨** –≤–∞—à hourly scheduler
2. ‚úÖ –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∏ –Ω–æ–≤—ã–µ lead_syncing —Ñ—É–Ω–∫—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
3. ‚úÖ –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –æ–±–∞ scheduler –≤ –æ–¥–∏–Ω hooks.py

---

#### 7.4. üü° ignore_links_on_delete - –î–û–ë–ê–í–õ–ï–ù

**–í frappe/main:**
```python
ignore_links_on_delete = ["Failed Lead Sync Log"]
```

**–í –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ:**
- –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ: `# ignore_links_on_delete = ["Communication", "ToDo"]`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚úÖ –ú–æ–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å —ç—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
2. ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Failed Lead Sync Log –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å –≤–∞—à–µ–π –ª–æ–≥–∏–∫–æ–π

---

## üìã –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ò–ó–ú–ï–ù–ï–ù–ò–ô –í HOOKS.PY

| –≠–ª–µ–º–µ–Ω—Ç | –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ç–∫–∞ | frappe/main | –î–µ–π—Å—Ç–≤–∏–µ |
|---------|-----------------|-------------|----------|
| `permission_query_conditions` | ‚úÖ –ê–∫—Ç–∏–≤–Ω—ã | ‚ùå –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `doc_events` (CRM Lead/Deal/Task) | ‚úÖ –ï—Å—Ç—å | ‚ùå –£–¥–∞–ª–µ–Ω—ã | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `doc_events` (Avito Message) | ‚úÖ –ï—Å—Ç—å | ‚ùå –£–¥–∞–ª–µ–Ω—ã | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `scheduler_events` (update_email_references) | ‚úÖ –ï—Å—Ç—å | ‚ùå –£–¥–∞–ª–µ–Ω | **–°–û–•–†–ê–ù–ò–¢–¨** |
| `scheduler_events` (lead_syncing) | ‚ùå –ù–µ—Ç | ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã | –ü—Ä–∏–Ω—è—Ç—å (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã) |
| `ignore_links_on_delete` | –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ | ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω | –ü—Ä–∏–Ω—è—Ç—å |

---

## ‚úÖ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô –î–õ–Ø HOOKS.PY

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ hooks (–î–û –º–µ—Ä–∂–∞)

1. ‚úÖ **–°–æ–∑–¥–∞—Ç—å backup hooks.py:**
   ```bash
   cp crm/hooks.py crm/hooks.py.backup
   ```

2. ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≤–∞—à–∏ hooks:**
   - permission_query_conditions
   - doc_events –¥–ª—è CRM Lead/Deal/Task
   - doc_events –¥–ª—è Avito Message
   - scheduler_events –¥–ª—è update_email_references

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞

3. üîß **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –≤–∞—à–∏ hooks:**
   - –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å/–¥–æ–±–∞–≤–∏—Ç—å permission_query_conditions
   - –î–æ–±–∞–≤–∏—Ç—å doc_events –¥–ª—è CRM Lead/Deal/Task
   - –î–æ–±–∞–≤–∏—Ç—å doc_events –¥–ª—è Avito Message
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å scheduler –¥–ª—è update_email_references

4. üîß **–û–±—ä–µ–¥–∏–Ω–∏—Ç—å scheduler:**
   - –û—Å—Ç–∞–≤–∏—Ç—å –≤–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é update_email_references
   - –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ lead_syncing —Ñ—É–Ω–∫—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)

5. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:**
   - –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (Sales User –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏)
   - Realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - Email references –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–∫–∞–∂–¥—ã–π —á–∞—Å)

---

### 8. üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø –í APP.VUE (–ö–†–ò–¢–ò–ß–ù–û)

**–í–ê–ñ–ù–û:** –í `frappe/main` **–ù–ï–¢** –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã Redis warmup –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã!

#### 8.1. üü¢ –í–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è App.vue (–ö–†–ò–¢–ò–ß–ù–ê)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ **Redis warmup –ø—Ä–æ–≤–µ—Ä–∫–∞** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
- ‚úÖ **LoadingView** - –ø–æ–∫–∞–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ **Network error handling** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
- ‚úÖ **Polling —Å–∏—Å—Ç–µ–º—ã** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `crm.api.system.get_redis_cache_status`

**–í frappe/main:**
- ‚ùå **–ù–ï–¢** Redis warmup –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚ùå **–ù–ï–¢** LoadingView
- ‚ùå –ü—Ä–æ—Å—Ç–∞—è –≤–µ—Ä—Å–∏—è –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –¢–æ–ª—å–∫–æ –±–∞–∑–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å NotPermitted page

**–†–∞–∑–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
- –£–¥–∞–ª–µ–Ω–æ: 272 —Å—Ç—Ä–æ–∫–∏ (–≤—Å—è –≤–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞!)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–û–•–†–ê–ù–ò–¢–¨** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
2. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—é –ª–æ–≥–∏–∫—É Redis warmup
3. ‚úÖ –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å NotPermitted page –∏–∑ frappe/main (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞)

---

### 9. üü° –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ Activities.vue

**–†–∞–∑–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
- –£–¥–∞–ª–µ–Ω–æ: 546 —Å—Ç—Ä–æ–∫
- –£–ø—Ä–æ—â–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

**–í–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Avito –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ WhatsApp
- ‚úÖ –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Avito —Ä–∞–±–æ—Ç–∞–µ—Ç
2. üîß –í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ç–∏–ø—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π

---

### 10. üü° –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ API —Ñ–∞–π–ª–∞—Ö

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö API:**
- `crm/api/doc.py` - 360 —Å—Ç—Ä–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–æ (208 –¥–æ–±–∞–≤–ª–µ–Ω–æ, 279 —É–¥–∞–ª–µ–Ω–æ)
- `crm/api/activities.py` - 127 —Å—Ç—Ä–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–æ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤–∞—à–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
2. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞
3. üîß –í–æ–∑–º–æ–∂–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤ —ç—Ç–∏—Ö —Ñ–∞–π–ª–∞—Ö

---

### 11. üü° –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ DocTypes

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- `CRM Deal` - 66 –ø–æ–ª–µ–π –∏–∑–º–µ–Ω–µ–Ω–æ
- `CRM Lead` - 85 –ø–æ–ª–µ–π –∏–∑–º–µ–Ω–µ–Ω–æ
- –ú–Ω–æ–≥–æ –¥—Ä—É–≥–∏—Ö DocTypes –∏–∑–º–µ–Ω–µ–Ω–æ

**–í–∞—à–∏ –ø–æ–ª—è:**
- ‚úÖ `sales_funnel` –≤ CRM Deal - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ
- ‚ö†Ô∏è –í CRM Lead —Ç–æ–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ sales_funnel

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–ª–µ `sales_funnel` —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ CRM Deal
2. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ DocTypes –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞
3. üîß –í–æ–∑–º–æ–∂–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤ JSON —Ñ–∞–π–ª–∞—Ö DocTypes

---

### 12. üü° –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ crm/www/crm.py

**–†–∞–∑–ª–∏—á–∏—è:**

**–í frappe/main:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `check_app_permission()` –≤ `get_context()`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `subprocess` –¥–ª—è git –∫–æ–º–∞–Ω–¥ –≤ `get_app_version()`
- ‚ùå –£–¥–∞–ª–µ–Ω–æ `app_version` –∏–∑ `get_boot()`

**–í –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ:**
- ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ `check_app_permission()` –≤ `get_context()`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á—Ç–µ–Ω–∏–µ `version.json` —Ñ–∞–π–ª–∞ –¥–ª—è `get_app_version()`
- ‚úÖ `app_version` –≤–∫–ª—é—á–µ–Ω –≤ `get_boot()`

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. ‚úÖ **–ü—Ä–∏–Ω—è—Ç—å** –ø—Ä–æ–≤–µ—Ä–∫—É `check_app_permission()` –∏–∑ frappe/main (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
2. ‚ö†Ô∏è **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å** –ª–æ–≥–∏–∫—É `get_app_version()` –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ç–∫–∏ (—á–∏—Ç–∞–µ—Ç version.json)
3. ‚úÖ **–û–±—ä–µ–¥–∏–Ω–∏—Ç—å** –æ–±–∞ –ø–æ–¥—Ö–æ–¥–∞ –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –≤ get_context()
2. ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É —á—Ç–µ–Ω–∏—è version.json
3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

### 7. üü¢ –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ frappe/main

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**

1. **Facebook Lead Forms –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
   - `crm/lead_syncing/` - –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å
   - `Facebook Lead Form` DocType
   - `Lead Sync Source` DocType
   - –§–æ–Ω–æ–≤—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ª–∏–¥–æ–≤

2. **CRM Rolling Response Time:**
   - –ù–æ–≤—ã–π DocType –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞
   - –°—Ç–∞—Ç—É—Å—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è rolling responses

3. **–£–ª—É—á—à–µ–Ω–∏—è –≤ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è /crm
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ Website Users

4. **–£–ª—É—á—à–µ–Ω–∏—è –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
   - –ù–æ–≤—ã–π ConditionsFilter –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
   - –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤

5. **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏:**
   - –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø–µ—Ä–µ–≤–æ–¥–æ–≤
   - –ù–æ–≤—ã–µ —è–∑—ã–∫–∏ (–¥–∞–ª—å—Å–∫–∏–π –∏ –¥—Ä.)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚úÖ –û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–æ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
2. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Facebook Lead Forms (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

### 8. üü° –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**package.json:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ 18 –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
- `frontend/yarn.lock` - 5088 –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫

**yarn.lock:**
- –£–¥–∞–ª–µ–Ω —Å—Ç–∞—Ä—ã–π `yarn.lock` (5027 —Å—Ç—Ä–æ–∫)
- –ù–æ–≤—ã–π `frontend/yarn.lock` (5088 —Å—Ç—Ä–æ–∫)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `yarn install` –≤ –ø–∞–ø–∫–µ frontend
2. ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å node_modules

---

## üìã –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô –ü–†–ò –°–õ–ò–Ø–ù–ò–ò

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–ü–ï–†–ï–î –º–µ—Ä–∂–µ–º)

1. ‚úÖ **–°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—ã–π backup —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏:**
   ```bash
   git branch backup-develop-$(date +%Y%m%d)
   ```

2. ‚úÖ **–°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö Avito —Ñ–∞–π–ª–æ–≤:**
   ```bash
   git ls-files | grep -i avito > avito_files.txt
   ```

3. ‚úÖ **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥:**
   ```bash
   git ls-files frontend/src/components/custom-ui/onboarding/ > onboarding_files.txt
   ```

4. ‚úÖ **–°–æ–∑–¥–∞—Ç—å patch —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏:**
   ```bash
   git format-patch -1 HEAD
   ```

5. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å git:**
   ```bash
   git status
   git stash  # –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
   ```

### –≠—Ç–∞–ø 2: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–µ—Ä–∂–∞

1. ‚úÖ **–ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
   ```bash
   git fetch frappe main
   ```

2. ‚ö†Ô∏è **–í—ã–ø–æ–ª–Ω–∏—Ç—å –º–µ—Ä–∂ (–±—É–¥–µ—Ç –º–Ω–æ–≥–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤):**
   ```bash
   git merge frappe/main --no-commit --no-ff
   ```

3. ‚ö†Ô∏è **–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
   ```bash
   git merge -Xours frappe/main  # –¥–ª—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤—ã–±–∏—Ä–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
   # –ò–õ–ò
   git merge -Xtheirs frappe/main  # –¥–ª—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤—ã–±–∏—Ä–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ frappe/main
   ```

### –≠—Ç–∞–ø 3: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (–ü–û–°–õ–ï –º–µ—Ä–∂–∞)

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã

1. üî¥ **Avito –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã Avito –∏–∑ backup
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ hooks –≤ `crm/hooks.py` —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

2. üî¥ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞:**
   - –ü—Ä–∏–Ω—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ frappe/main
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É `get_app_version()` –µ—Å–ª–∏ –Ω—É–∂–Ω–∞
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø

3. üü° **–ö–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥:**
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥
   - –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤ 2 —Ñ–∞–π–ª–∞—Ö
   - –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –í–∞–∂–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã

4. üü° **API —Ñ–∞–π–ª—ã:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö API
   - –ü–æ–Ω—è—Ç—å, –∫—É–¥–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
   - –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã

5. üü° **Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å UI

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –í—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã

6. üü¢ **–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
   - –û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–æ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
   - –†–µ—à–∏—Ç—å, –Ω—É–∂–Ω—ã –ª–∏ –æ–Ω–∏
   - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

7. üü¢ **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   - –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### –≠—Ç–∞–ø 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. ‚úÖ **–ë–∞–∑–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ Avito –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞

2. ‚úÖ **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –°–æ–∑–¥–∞–Ω–∏–µ –ª–∏–¥–æ–≤/—Å–¥–µ–ª–æ–∫
   - –†–∞–±–æ—Ç–∞ —Å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º–∏
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏
   - –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞

3. ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - Avito –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
   - WhatsApp (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
   - –¢–µ–ª–µ—Ñ–æ–Ω–∏—è

### –≠—Ç–∞–ø 5: –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è

1. ‚úÖ **–ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
   ```bash
   git add .
   git commit -m "Merge frappe/main with custom Avito integration and onboarding"
   ```

2. ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
   - –û–±–Ω–æ–≤–∏—Ç—å README –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
   - –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏ —Ä–µ—à–µ–Ω–∏—è

3. ‚úÖ **–¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```bash
   git tag -a v1.56.4-custom -m "Merged with frappe/main + custom features"
   ```

---

## üîß –ó–ê–î–ê–ß–ò –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏

1. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞:**
   - [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ `InviteUserPage.vue` –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥
   - [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ `ChangePasswordModal.vue` –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥
   - [ ] –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—ã–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞
   - [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞ –≤ –ª–∏–Ω—Ç–µ—Ä

2. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ Avito –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
   - [ ] –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –¥–ª—è Avito (`crm/integrations/avito/`)
   - [ ] –†–∞–∑–¥–µ–ª–∏—Ç—å API –∏ frontend –ª–æ–≥–∏–∫—É
   - [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è Avito –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
   - [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å API Avito

3. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤:**
   - [ ] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É `get_app_version()` —Å –Ω–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø—Ä–∞–≤
   - [ ] –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—É—é —Ç–æ—á–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
   - [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–∞–¥–∞—á–∏

4. **–£–ª—É—á—à–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**
   - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö API
   - [ ] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –Ω–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
   - [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É frontend —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–æ–≤—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

5. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - [ ] –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
   - [ ] –°–æ–∑–¥–∞—Ç—å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–ª–∏—è–Ω–∏—é —Å upstream
   - [ ] –û–±–Ω–æ–≤–∏—Ç—å CHANGELOG

6. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - [ ] –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è Avito
   - [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞
   - [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

---

## ‚ö†Ô∏è –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

1. **–ü–æ—Ç–µ—Ä—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ Avito:**
   - –†–∏—Å–∫: –í—ã—Å–æ–∫–∏–π
   - –†–µ—à–µ–Ω–∏–µ: –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π backup –ø–µ—Ä–µ–¥ –º–µ—Ä–∂–µ–º

2. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–µ:**
   - –†–∏—Å–∫: –°—Ä–µ–¥–Ω–∏–π
   - –†–µ—à–µ–Ω–∏–µ: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—É—é –≤–µ—Ä—Å–∏—é –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞

3. **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ API —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:**
   - –†–∏—Å–∫: –°—Ä–µ–¥–Ω–∏–π
   - –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É–¥–∞–ª–µ–Ω–Ω—ã—Ö API

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

4. **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö:**
   - –†–∏—Å–∫: –°—Ä–µ–¥–Ω–∏–π
   - –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ UI –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞

5. **–ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   - –†–∏—Å–∫: –ù–∏–∑–∫–∏–π
   - –†–µ—à–µ–Ω–∏–µ: –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

6. **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ DocTypes:**
   - –†–∏—Å–∫: –°—Ä–µ–¥–Ω–∏–π
   - –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏ —Å–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

---

## üìù –ó–ê–ú–ï–¢–ö–ò

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏

- –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–º–º–∏—Ç: —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ Avito (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `chat_id`)
- –ö–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ frappe-ui v0.1.121
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Avito –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–∞—Å—Ç–æ–º–Ω–∞—è

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ frappe/main

- –û—á–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (~100 –∫–æ–º–º–∏—Ç–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö)
- –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ bugfix –∏ —É–ª—É—á—à–µ–Ω–∏–π
- –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Facebook Lead Forms, Rolling Response Time)

---

## üéØ –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø –°–õ–ò–Ø–ù–ò–Ø –° –ö–ê–¢–ï–ì–û–†–ò–ó–ê–¶–ò–ï–ô –§–ê–ô–õ–û–í

### –ü–æ–¥—Ö–æ–¥: –¢—Ä–µ—Ö—ç—Ç–∞–ø–Ω—ã–π –º–µ—Ä–∂ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–µ–π

–í–º–µ—Å—Ç–æ —Ä—É—á–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤—Å–µ—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤, —Ä–∞–∑–¥–µ–ª–∏–º —Ñ–∞–π–ª—ã –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø—Ä–∏–º–µ–Ω–∏–º –∫ –∫–∞–∂–¥–æ–π —Å–≤–æ—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é.

---

## üìÇ –ö–ê–¢–ï–ì–û–†–ò–ò –§–ê–ô–õ–û–í

### üü¢ –ö–ê–¢–ï–ì–û–†–ò–Ø A: –ù–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ–∞–π–ª—ã (–°–û–•–†–ê–ù–ò–¢–¨ –ö–ê–ö –ï–°–¢–¨)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** –≠—Ç–∏ —Ñ–∞–π–ª—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—à–∏, –∏—Ö –Ω–µ—Ç –≤ frappe/main. –ù—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞.

**–°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤:**

```bash
# Avito –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—à–∞)
crm/api/avito.py
crm/hooks.py  # —á–∞—Å—Ç–∏—á–Ω–æ - —Ç–æ–ª—å–∫–æ hooks –¥–ª—è Avito
frontend/src/components/Activities/AvitoArea.vue
frontend/src/components/Activities/AvitoBox.vue
frontend/src/components/Icons/AvitoIcon.vue
frontend/src/composables/avito.js
frontend/src/components/Settings/AvitoSettings.vue

# –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (–ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞)
crm/permissions.py

# API —Ñ–∞–π–ª—ã (–Ω–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ)
crm/api/performance.py
crm/api/system.py
crm/api/cache_status.py
crm/api/communication.py
crm/api/address.py
crm/api/assignment.py
crm/api/telephony.py

# DocTypes –∏ Reports (–Ω–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ)
crm/fcrm/doctype/crm_funnel/
crm/fcrm/doctype/sales_funnel_report_document/
crm/fcrm/report/sales_funnel_conversion/

# Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–Ω–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ)
frontend/src/components/Controls/SingleImageUploader.vue
frontend/src/components/custom-ui/onboarding/onboarding.js
```

**–î–µ–π—Å—Ç–≤–∏–µ:** 
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å backup –≤—Å–µ—Ö —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤
2. ‚úÖ –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ–Ω–∏ –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç —Å –Ω–æ–≤—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

---

### üü° –ö–ê–¢–ï–ì–û–†–ò–Ø B: –§–∞–π–ª—ã —Å –Ω–∞—à–∏–º–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ (–†–£–ß–ù–û–ï –°–õ–ò–Ø–ù–ò–ï)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** –í —ç—Ç–∏—Ö —Ñ–∞–π–ª–∞—Ö –µ—Å—Ç—å –∏ –Ω–∞—à–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è frappe/main. –ù—É–∂–Ω–æ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å.

**–°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤:**

```bash
# –ö–†–ò–¢–ò–ß–ù–´–ï - –Ω–∞—à–∏ hooks
crm/hooks.py
  ‚îú‚îÄ permission_query_conditions (–ù–ê–®–ò)
  ‚îú‚îÄ doc_events –¥–ª—è CRM Lead/Deal/Task (–ù–ê–®–ò)
  ‚îú‚îÄ doc_events –¥–ª—è Avito Message (–ù–ê–®–ò)
  ‚îú‚îÄ scheduler_events –¥–ª—è update_email_references (–ù–ê–®–ò)
  ‚îî‚îÄ scheduler_events –¥–ª—è lead_syncing (–ò–• –ù–û–í–´–ï)

# –ö–†–ò–¢–ò–ß–ù–´–ï - –Ω–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è realtime
crm/api/doc.py
  ‚îú‚îÄ on_doc_update() —Ñ—É–Ω–∫—Ü–∏—è (–ù–ê–®–ê)
  ‚îî‚îÄ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–ú–û–ì–£–¢ –ë–´–¢–¨ –ò–• –ò–ó–ú–ï–ù–ï–ù–ò–Ø)

# –ö–†–ò–¢–ò–ß–ù–´–ï - –Ω–∞—à Redis warmup
frontend/src/App.vue
  ‚îú‚îÄ Redis warmup –ª–æ–≥–∏–∫–∞ (–ù–ê–®–ê)
  ‚îî‚îÄ NotPermitted page (–ò–• –ù–û–í–ê–Ø)

# Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å –Ω–∞—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
frontend/src/pages/Deal.vue
  ‚îî‚îÄ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞ (–ù–ê–®–ï)
frontend/src/pages/Lead.vue
  ‚îî‚îÄ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞ (–ù–ê–®–ï)
frontend/src/components/Activities/Activities.vue
  ‚îú‚îÄ Avito –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–ù–ê–®–ê)
  ‚îî‚îÄ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–ú–û–ì–£–¢ –ë–´–¢–¨ –ò–•)
```

**–î–µ–π—Å—Ç–≤–∏–µ:**
1. üîß –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –≤—Ä—É—á–Ω—É—é –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–∞—à–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å –∏—Ö
2. üîß –î–ª—è hooks.py - –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞—à–∏ hooks + –∏—Ö –Ω–æ–≤—ã–µ scheduler events
3. üîß –î–ª—è App.vue - –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å Redis warmup + NotPermitted
4. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª –ø–æ—Å–ª–µ —Å–ª–∏—è–Ω–∏—è

---

### üîµ –ö–ê–¢–ï–ì–û–†–ò–Ø C: –§–∞–π–ª—ã —Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ (–ü–†–ò–ù–Ø–¢–¨ –ò–• + –ù–ê–®–ò)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** –ú–æ–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π frappe/main, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Å—Ç–∞.

**–°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤:**

```bash
# –ú–æ–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å –∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—à–∏ –∏–º–ø–æ—Ä—Ç—ã
crm/www/crm.py
  ‚îú‚îÄ check_app_permission (–ò–• –ù–û–í–û–ï) ‚úÖ –ø—Ä–∏–Ω—è—Ç—å
  ‚îî‚îÄ get_app_version (–ù–ê–®–ï) - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω—É–∂–Ω–∞ –ª–∏

# –ú–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –Ω–æ –Ω–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Å—Ç–∞ —Ä–µ–¥–∫–∏
frontend/src/components/Activities/ActivityHeader.vue
frontend/src/components/Filter.vue
crm/api/activities.py
crm/api/dashboard.py
crm/api/todo.py
crm/api/whatsapp.py

# DocTypes —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –ø–æ–ª–µ–π
crm/fcrm/doctype/crm_deal/crm_deal.json
crm/fcrm/doctype/crm_lead/crm_lead.json
  ‚îî‚îÄ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–ª–µ sales_funnel —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ
```

**–î–µ–π—Å—Ç–≤–∏–µ:**
1. ‚úÖ –ü—Ä–∏–Ω—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è frappe/main
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–æ–ª—è/—Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
3. ‚úÖ –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—Ç–µ—Ä—è–Ω–æ - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é

---

### üî¥ –ö–ê–¢–ï–ì–û–†–ò–Ø D: –§–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (–ö–†–ò–¢–ò–ß–ù–û - –í–ê–®–ò –ü–ï–†–ï–í–û–î–´ –õ–£–ß–®–ï!)

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** –í–∞—à–∏ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –±–æ–ª–µ–µ –ø–æ–ª–Ω—ã–µ! –ù—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–∞—à–∏ –≤–µ—Ä—Å–∏–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫ –∏–∑ frappe/main.

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ö†Ô∏è –í `frappe/main` —á–∞—Å—Ç–æ –æ—Å—Ç–∞–≤–ª—è—é—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º (–±–µ–∑ `__()`)
- ‚ö†Ô∏è –í –≤–∞—à–µ–π –≤–µ—Ä—Å–∏–∏ `ru.csv` - 457 —Å—Ç—Ä–æ–∫, –≤ frappe/main –º–µ–Ω—å—à–µ (–≤–∞—à–∞ –≤–µ—Ä—Å–∏—è –±–æ–ª–µ–µ –ø–æ–ª–Ω–∞—è!)
- ‚ö†Ô∏è –û–≥—Ä–æ–º–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `ru.po` (6088 —Å—Ç—Ä–æ–∫)
- ‚ö†Ô∏è –ë—É–¥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤ —Ñ–∞–π–ª–∞—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –ø—Ä–∏ –º–µ—Ä–∂–µ

**–°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤:**

```bash
# –ö–†–ò–¢–ò–ß–ù–û - –≤–∞—à–∏ –ø–µ—Ä–µ–≤–æ–¥—ã –±–æ–ª–µ–µ –ø–æ–ª–Ω—ã–µ!
crm/translations/ru.csv  # –í –≤–∞—à–µ–π –≤–µ—Ä—Å–∏–∏ 457 —Å—Ç—Ä–æ–∫ (–≤ frappe/main –º–µ–Ω—å—à–µ!)
crm/locale/ru.po         # –û–≥—Ä–æ–º–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (6088 —Å—Ç—Ä–æ–∫)
crm/locale/ru.mo         # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª

# –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —Å—Ç–∞—Ç—É—Å–æ–≤
frontend/src/utils/dealStatusTranslations.js
frontend/src/utils/leadStatusTranslations.js
frontend/src/utils/taskPriorityTranslations.js

# –î—Ä—É–≥–∏–µ —è–∑—ã–∫–∏ - –º–æ–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
crm/translations/*.csv (–∫—Ä–æ–º–µ ru.csv)
crm/locale/*.po (–∫—Ä–æ–º–µ ru.po)
```

**–î–µ–π—Å—Ç–≤–∏–µ:**
1. ‚úÖ **–í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—à—É –≤–µ—Ä—Å–∏—é** `ru.csv` –∏ `ru.po` (–æ–Ω–∏ –±–æ–ª–µ–µ –ø–æ–ª–Ω—ã–µ!)
2. ‚úÖ –ù–∞–π—Ç–∏ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ frappe/main –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã
3. ‚úÖ –ù–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–∞—Ö (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `./find-hardcoded-strings.sh`)
4. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

**–°–º. –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω:** –≠–¢–ê–ü 6.5 - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤

---

### üü¢ –ö–ê–¢–ï–ì–û–†–ò–Ø E: –ë–µ–∑–æ–ø–∞—Å–Ω–æ –ø—Ä–∏–Ω—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è frappe/main

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** –≠—Ç–∏ —Ñ–∞–π–ª—ã –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–∑ frappe/main –±–µ–∑ —Ä–∏—Å–∫–∞.

**–°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤:**

```bash
# –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ - –≤—Å–µ–≥–¥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ
translations/**/*.json

# –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ frappe/main
crm/lead_syncing/  # Facebook Lead Forms (–Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
crm/fcrm/doctype/crm_rolling_response_time/
crm/fcrm/doctype/facebook_lead_form/
crm/fcrm/doctype/facebook_page/
crm/fcrm/doctype/lead_sync_source/

# –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
frontend/src/components/ConditionsFilter/

# –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
frontend/package.json
frontend/yarn.lock

# –î—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã –±–µ–∑ –Ω–∞—à–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
# (–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –ø–æ–ø–∞–¥—É—Ç —Å—é–¥–∞)
```

**–î–µ–π—Å—Ç–≤–∏–µ:**
1. ‚úÖ –ü—Ä–æ—Å—Ç–æ –ø—Ä–∏–Ω—è—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ frappe/main
2. ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã (–∫—Ä–æ–º–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

---

## üöÄ –ü–û–®–ê–ì–û–í–´–ô –ü–õ–ê–ù –°–õ–ò–Ø–ù–ò–Ø

### –≠–¢–ê–ü 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–ü–ï–†–ï–î –º–µ—Ä–∂–µ–º)

```bash
# 1. –°–æ–∑–¥–∞—Ç—å backup –≤–µ—Ç–∫—É
git branch backup-develop-$(date +%Y%m%d-%H%M%S)

# 2. –°–æ–∑–¥–∞—Ç—å backup –≤—Å–µ—Ö –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
mkdir -p ../merge_backup/category_a
mkdir -p ../merge_backup/category_b

# Backup –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ A (–ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—à–∏ —Ñ–∞–π–ª—ã)
cd /home/bucher/frappe_docker/development/frappe-bench/apps/crm
tar -czf ../merge_backup/category_a/custom_files.tar.gz \
  crm/api/avito.py \
  crm/api/performance.py \
  crm/api/system.py \
  crm/api/cache_status.py \
  crm/api/communication.py \
  crm/api/address.py \
  crm/api/assignment.py \
  crm/api/telephony.py \
  crm/permissions.py \
  crm/fcrm/doctype/crm_funnel \
  crm/fcrm/doctype/sales_funnel_report_document \
  crm/fcrm/report/sales_funnel_conversion \
  frontend/src/components/Controls/SingleImageUploader.vue \
  frontend/src/components/custom-ui/onboarding \
  frontend/src/components/Activities/Avito*.vue \
  frontend/src/components/Icons/AvitoIcon.vue \
  frontend/src/composables/avito.js \
  frontend/src/components/Settings/AvitoSettings.vue

# Backup –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ B (—Ñ–∞–π–ª—ã —Å –Ω–∞—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏)
cp crm/hooks.py ../merge_backup/category_b/hooks.py.backup
cp crm/api/doc.py ../merge_backup/category_b/doc.py.backup
cp frontend/src/App.vue ../merge_backup/category_b/App.vue.backup

# 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ hooks
git show HEAD:crm/hooks.py > ../merge_backup/category_b/hooks.py.original
git show HEAD:crm/api/doc.py > ../merge_backup/category_b/doc.py.original
git show HEAD:frontend/src/App.vue > ../merge_backup/category_b/App.vue.original

echo "‚úÖ Backup —Å–æ–∑–¥–∞–Ω –≤ ../merge_backup/"
```

---

### –≠–¢–ê–ü 2: –ú–µ—Ä–∂ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º (–≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ)

```bash
# –°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É –¥–ª—è –º–µ—Ä–∂–∞
git checkout -b merge-frappe-main develop

# –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–µ—Ä–∂
git merge frappe/main --no-commit --no-ff

# Git –ø–æ–∫–∞–∂–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã - –º—ã –∏—Ö –±—É–¥–µ–º —Ä–µ—à–∞—Ç—å –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
```

---

### –≠–¢–ê–ü 3: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

#### 3.1. –ö–∞—Ç–µ–≥–æ—Ä–∏—è A: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ–∞–π–ª—ã

```bash
# –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ A
cd /home/bucher/frappe_docker/development/frappe-bench/apps/crm

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup
tar -xzf ../merge_backup/category_a/custom_files.tar.gz

# –î–æ–±–∞–≤–∏—Ç—å –≤ git
git add crm/api/avito.py
git add crm/api/performance.py
git add crm/api/system.py
git add crm/api/cache_status.py
git add crm/api/communication.py
git add crm/api/address.py
git add crm/api/assignment.py
git add crm/api/telephony.py
git add crm/permissions.py
# ... –∏ —Ç.–¥. –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ A

echo "‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è A –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
```

#### 3.2. –ö–∞—Ç–µ–≥–æ—Ä–∏—è B: –†—É—á–Ω–æ–µ —Å–ª–∏—è–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

**–î–ª—è hooks.py:**
```python
# –ù—É–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å:
# - –ù–∞—à–∏: permission_query_conditions, doc_events, scheduler_events (update_email_references)
# - –ò—Ö: scheduler_events (lead_syncing), –Ω–æ–≤—ã–µ ignore_links_on_delete

# –®–∞–±–ª–æ–Ω —Å–ª–∏—è–Ω–∏—è hooks.py:
permission_query_conditions = {
    "CRM Deal": "crm.permissions.get_permission_query_conditions_for_crm_deal",
    "CRM Lead": "crm.permissions.get_permission_query_conditions_for_crm_lead",
    "CRM Task": "crm.permissions.get_permission_query_conditions_for_crm_task"
}

doc_events = {
    # –ù–∞—à–∏ hooks
    "CRM Lead": {
        "on_update": "crm.api.doc.on_doc_update",
        "after_insert": "crm.api.doc.on_doc_update",
        "on_trash": "crm.api.doc.on_doc_update",
    },
    "CRM Deal": {
        "on_update": [
            "crm.api.doc.on_doc_update",
            "crm.fcrm.doctype.erpnext_crm_settings.erpnext_crm_settings.create_customer_in_erpnext"
        ],
        "after_insert": "crm.api.doc.on_doc_update",
        "on_trash": "crm.api.doc.on_doc_update",
    },
    "CRM Task": {
        "on_update": "crm.api.doc.on_doc_update",
        "after_insert": "crm.api.doc.on_doc_update",
        "on_trash": "crm.api.doc.on_doc_update",
    },
    "Avito Message": {
        "validate": ["crm.api.avito.validate"],
        "on_update": ["crm.api.avito.on_update"],
    },
    # –ò—Ö hooks (–æ—Å—Ç–∞–ª—å–Ω—ã–µ)
    "Contact": {...},
    "ToDo": {...},
    # –∏ —Ç.–¥.
}

scheduler_events = {
    # –ù–∞—à scheduler
    "hourly": [
        "crm.api.communication.update_email_references"
    ],
    # –ò—Ö –Ω–æ–≤—ã–µ schedulers
    "daily_long": [...],
    "hourly_long": [...],
    # –∏ —Ç.–¥.
}
```

**–î–ª—è crm/api/doc.py:**
```python
# –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è on_doc_update() —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
# –ï—Å–ª–∏ –µ—ë –Ω–µ—Ç - –¥–æ–±–∞–≤–∏—Ç—å –∏–∑ backup

# –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ (–∏–ª–∏ –≥–¥–µ –±—ã–ª–∞):
def on_doc_update(doc, method=None):
    """Publish updates to subscribed clients"""
    if doc.doctype not in ['CRM Lead', 'CRM Deal', 'CRM Task']:
        return
    # ... (–∫–æ–¥ –∏–∑ backup)
```

**–î–ª—è frontend/src/App.vue:**
```vue
<!-- –ù—É–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å:
     - –ù–∞—à–∞ Redis warmup –ª–æ–≥–∏–∫–∞
     - –ò—Ö NotPermitted page
-->

<template>
  <FrappeUIProvider>
    <!-- –ù–∞—à–∞ LoadingView —Å Redis warmup -->
    <LoadingView 
      v-if="redisWarmup.isWarmingUp || hasNetworkErrors || translationsLoading"
      ...
    />
    
    <!-- –ò—Ö NotPermitted page -->
    <NotPermitted v-if="$route.name === 'Not Permitted'" />
    
    <!-- –û—Å—Ç–∞–ª—å–Ω–æ–µ -->
    ...
  </FrappeUIProvider>
</template>
```

#### 3.3. –ö–∞—Ç–µ–≥–æ—Ä–∏—è C: –ü—Ä–∏–Ω—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è + –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—à–∏ –º–µ—Å—Ç–∞

```bash
# –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤ - –ø—Ä–∏–Ω—è—Ç—å –∏—Ö –≤–µ—Ä—Å–∏—é
git checkout --theirs crm/www/crm.py  # –ø—Ä–∏–Ω—è—Ç—å –∏—Ö –≤–µ—Ä—Å–∏—é
# –ü–æ—Ç–æ–º –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞—à–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –µ—Å–ª–∏ –Ω—É–∂–Ω—ã

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã
git diff HEAD crm/www/crm.py | grep -i "app_version\|check_app_permission"
```

#### 3.4. –ö–∞—Ç–µ–≥–æ—Ä–∏—è D: –ü—Ä–æ—Å—Ç–æ –ø—Ä–∏–Ω—è—Ç—å (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

```bash
# –≠—Ç–∏ —Ñ–∞–π–ª—ã –ø—Ä–∏–º—É—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –º–µ—Ä–∂–µ
# –ü—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:
git status | grep "both modified"
```

---

### –≠–¢–ê–ü 4: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∫–æ–º–º–∏—Ç

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –Ω–∞—à–∏ —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ
ls -la crm/api/avito.py
ls -la crm/permissions.py
ls -la crm/api/performance.py
# ... –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ A

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å hooks
grep -A 3 "permission_query_conditions" crm/hooks.py
grep -A 3 "doc_events" crm/hooks.py | grep "CRM Lead\|CRM Deal\|CRM Task"
grep "update_email_references" crm/hooks.py

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é on_doc_update
grep -A 20 "def on_doc_update" crm/api/doc.py

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å App.vue
grep "redisWarmup\|LoadingView" frontend/src/App.vue

# 5. –ï—Å–ª–∏ –≤—Å—ë –æ–∫ - –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å
git add .
git commit -m "merge: merge frappe/main with custom features preserved

- Preserved custom Avito integration
- Preserved custom permissions system
- Preserved custom API files (performance, system, communication, etc.)
- Preserved custom DocTypes (CRM Funnel, Sales Funnel reports)
- Preserved custom onboarding
- Merged hooks.py (custom + new schedulers)
- Merged App.vue (Redis warmup + NotPermitted)
- Preserved realtime doc_update events"

echo "‚úÖ –ú–µ—Ä–∂ –∑–∞–≤–µ—Ä—à–µ–Ω!"
```

---

### –≠–¢–ê–ü 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
cd frontend
yarn install

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è
# (–∑–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä –∏–ª–∏ build)

# 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
# - Avito –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
# - –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (Sales User –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã)
# - Realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–æ—Ç–∫—Ä—ã—Ç—å –¥–≤–∞ –æ–∫–Ω–∞)
# - Redis warmup (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É)
# - Email references (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ scheduler —Ä–∞–±–æ—Ç–∞–µ—Ç)
```

---

### –≠–¢–ê–ü 6: –ù–µ–±–æ–ª—å—à–∏–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Ñ–æ—Ä–∫–∞ (–£–ª—É—á—à–µ–Ω–∏—è –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –º–µ—Ä–∂–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –Ω–µ–±–æ–ª—å—à–∏–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–∫–∞.

#### 6.1. üü° –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ–∞–π–ª—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥ –∏–∑ `frappe-ui/frappe` –≤–º–µ—Å—Ç–æ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ.

**–§–∞–π–ª—ã –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

1. **`frontend/src/components/Settings/InviteUserPage.vue`**
   ```javascript
   // –ë–´–õ–û:
   import { useOnboarding } from 'frappe-ui/frappe'
   
   // –î–û–õ–ñ–ù–û –ë–´–¢–¨:
   import { useOnboarding } from '@/components/custom-ui/onboarding/onboarding'
   ```

2. **`frontend/src/components/Modals/ChangePasswordModal.vue`**
   ```javascript
   // –ë–´–õ–û:
   import { useOnboarding } from 'frappe-ui/frappe'
   
   // –î–û–õ–ñ–ù–û –ë–´–¢–¨:
   import { useOnboarding } from '@/components/custom-ui/onboarding/onboarding'
   ```

**–î–µ–π—Å—Ç–≤–∏—è:**
```bash
# 1. –ó–∞–º–µ–Ω–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ –æ–±–æ–∏—Ö —Ñ–∞–π–ª–∞—Ö
sed -i "s|from 'frappe-ui/frappe'|from '@/components/custom-ui/onboarding/onboarding'|g" \
  frontend/src/components/Settings/InviteUserPage.vue \
  frontend/src/components/Modals/ChangePasswordModal.vue

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
grep -n "useOnboarding" frontend/src/components/Settings/InviteUserPage.vue
grep -n "useOnboarding" frontend/src/components/Modals/ChangePasswordModal.vue

# 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á—Ç–æ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —ç—Ç–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
```

---

#### 6.2. üü° –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä—É–≥–∏—Ö –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–µ–π

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**

1. **`frontend/src/components/Mobile/MobileSidebar.vue`**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `TrialBanner` –∏–∑ `frappe-ui/frappe`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω—É–∂–µ–Ω –ª–∏ –æ–Ω –∏ –º–æ–∂–Ω–æ –ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å

2. **`frontend/src/components/Layouts/AppSidebar.vue`**
   - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —á—Ç–æ-—Ç–æ –∏–∑ `frappe-ui/frappe`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–º–µ–Ω–Ω–æ –∏ –Ω—É–∂–Ω–æ –ª–∏

**–î–µ–π—Å—Ç–≤–∏—è:**
```bash
# –ù–∞–π—Ç–∏ –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è frappe-ui/frappe
grep -r "from ['\"]frappe-ui/frappe['\"]" frontend/src --include="*.vue" --include="*.js" --include="*.ts"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∂–¥—ã–π —Å–ª—É—á–∞–π –∏ —Ä–µ—à–∏—Ç—å:
# - –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å (–µ—Å–ª–∏ —ç—Ç–æ –Ω–µ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥)
# - –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –∫–∞—Å—Ç–æ–º–Ω—ã–π (–µ—Å–ª–∏ —ç—Ç–æ –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥)
```

---

#### 6.3. üü¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π frappe/main

–ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Ä–µ—à–∏—Ç—å, –Ω—É–∂–Ω—ã –ª–∏ –æ–Ω–∏:

1. **Facebook Lead Forms –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
   - –ù–æ–≤—ã–π –º–æ–¥—É–ª—å `crm/lead_syncing/`
   - –ù–æ–≤—ã–µ DocTypes: `Facebook Lead Form`, `Facebook Page`, `Lead Sync Source`
   - **–†–µ—à–µ–Ω–∏–µ:** –ï—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Facebook - –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è –±—É–¥—É—â–µ–≥–æ, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç

2. **CRM Rolling Response Time**
   - –ù–æ–≤—ã–π DocType –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞
   - **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω—É–∂–µ–Ω –ª–∏, –µ—Å–ª–∏ –Ω–µ—Ç - –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å

3. **–ù–æ–≤—ã–π ConditionsFilter –∫–æ–º–ø–æ–Ω–µ–Ω—Ç**
   - –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
   - **–†–µ—à–µ–Ω–∏–µ:** –û—Å—Ç–∞–≤–∏—Ç—å - —ç—Ç–æ —É–ª—É—á—à–µ–Ω–∏–µ

**–î–µ–π—Å—Ç–≤–∏—è:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç

# 2. –ï—Å–ª–∏ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –Ω—É–∂–Ω—ã - –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å
# –ù–æ –ª—É—á—à–µ –æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –±—É–¥—É—â–µ–µ
```

---

#### 6.4. üü¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ DocTypes –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–æ–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ DocTypes:

1. **`crm/fcrm/doctype/crm_deal/crm_deal.json`**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–ª–µ `sales_funnel` (Link to CRM Funnel) –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

2. **`crm/fcrm/doctype/crm_lead/crm_lead.json`**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ–ª–µ–π
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è –Ω–∞ –º–µ—Å—Ç–µ

**–î–µ–π—Å—Ç–≤–∏—è:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–µ sales_funnel –≤ CRM Deal
grep -A 5 '"fieldname": "sales_funnel"' crm/fcrm/doctype/crm_deal/crm_deal.json

# –ï—Å–ª–∏ –ø–æ–ª—è –Ω–µ—Ç - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é
```

---

#### 6.5. üî¥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (–ö–†–ò–¢–ò–ß–ù–û!)

**–í–ê–ñ–ù–û:** –£ –≤–∞—Å –º–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏–π –ø–µ—Ä–µ–≤–æ–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ `frappe/main`! –í frappe/main —á–∞—Å—Ç–æ –æ—Å—Ç–∞–≤–ª—è—é—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º.

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ö†Ô∏è –í `frappe/main` –º–Ω–æ–≥–æ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º (–±–µ–∑ `__()`)
- ‚ö†Ô∏è –û–≥—Ä–æ–º–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–∞—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (—Ç—ã—Å—è—á–∏ —Å—Ç—Ä–æ–∫ –≤ locale —Ñ–∞–π–ª–∞—Ö)
- ‚ö†Ô∏è –ë—É–¥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤ —Ñ–∞–π–ª–∞—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –ø—Ä–∏ –º–µ—Ä–∂–µ
- ‚úÖ –£ –≤–∞—Å –µ—Å—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —Å—Ç–∞—Ç—É—Å–æ–≤ (dealStatusTranslations.js, leadStatusTranslations.js)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤:**
- `crm/translations/*.csv` - 83 —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤
- `crm/locale/*.po` - —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –¥–ª—è gettext
- `frontend/src/utils/dealStatusTranslations.js` - –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã —Å—Ç–∞—Ç—É—Å–æ–≤
- `frontend/src/utils/leadStatusTranslations.js` - –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã —Å—Ç–∞—Ç—É—Å–æ–≤
- `frontend/src/utils/taskPriorityTranslations.js` - –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

**–î–µ–π—Å—Ç–≤–∏—è:**

1. **–°–æ–∑–¥–∞—Ç—å backup —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (–î–û –º–µ—Ä–∂–∞):**
   ```bash
   # Backup –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
   mkdir -p ../merge_backup/translations
   cp -r crm/translations ../merge_backup/translations/
   cp -r crm/locale ../merge_backup/translations/
   cp frontend/src/utils/*Translations.js ../merge_backup/translations/
   
   # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏
   wc -l crm/translations/ru.csv > ../merge_backup/translations/ru_lines.txt
   ```

2. **–ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ - –Ω–∞–π—Ç–∏ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–∞—Ö:**
   ```bash
   # –ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫–∏ –≤ –∫–∞–≤—ã—á–∫–∞—Ö (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ)
   # –í –Ω–æ–≤—ã—Ö/–∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö –∏–∑ frappe/main
   git diff frappe/main HEAD --name-only | xargs grep -E "['\"][A-Z][a-z]+ [A-Z]|['\"][A-Z][a-z]{3,}" | \
     grep -v "__(" | grep -v "_(" | grep -v "\.__(" | head -50
   
   # –ù–∞–π—Ç–∏ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ frontend (–Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã)
   find frontend/src -name "*.vue" -o -name "*.js" | xargs grep -E "['\"][A-Z][a-z]+" | \
     grep -v "__(" | grep -v "translate" | head -30
   ```

3. **–û–±–µ—Ä–Ω—É—Ç—å –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ `__()`:**
   ```javascript
   // –ë–´–õ–û (–∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–æ):
   label: "New Deal"
   title: "Create Lead"
   
   // –î–û–õ–ñ–ù–û –ë–´–¢–¨:
   label: __("New Deal")
   title: __("Create Lead")
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤ —Ñ–∞–π–ª–∞—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤:**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞
   git status | grep -E "translations|locale"
   
   # –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã - —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∏—Ö, —Å–æ—Ö—Ä–∞–Ω–∏–≤ –≤–∞—à–∏ –ø–µ—Ä–µ–≤–æ–¥—ã
   # –î–ª—è ru.csv - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—à—É –≤–µ—Ä—Å–∏—é (–æ–Ω–∞ –±–æ–ª–µ–µ –ø–æ–ª–Ω–∞—è)
   git checkout --ours crm/translations/ru.csv
   
   # –î–ª—è –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤ - –º–æ–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å –∏—Ö, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
   ```

5. **–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫ –∏–∑ frappe/main:**
   ```bash
   # –ù–∞–π—Ç–∏ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ main.pot (—à–∞–±–ª–æ–Ω –ø–µ—Ä–µ–≤–æ–¥–æ–≤)
   git diff frappe/main HEAD crm/locale/main.pot | grep "^+msgid" | head -20
   
   # –î–ª—è –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –≤ ru.csv –∏ ru.po
   # –§–æ—Ä–º–∞—Ç CSV: "Original Text","–ü–µ—Ä–µ–≤–æ–¥",
   # –§–æ—Ä–º–∞—Ç PO: msgid "Original Text"
   #            msgstr "–ü–µ—Ä–µ–≤–æ–¥"
   ```

6. **–û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —Å—Ç–∞—Ç—É—Å–æ–≤:**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
   ls -la frontend/src/utils/*Translations.js
   
   # –ï—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–µ—Ä–µ–≤–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç
   # –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
   ```

7. **–†–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):**
   ```bash
   # –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ gettext –¥–ª—è backend –ø–µ—Ä–µ–≤–æ–¥–æ–≤
   cd crm/locale
   # –û–±–Ω–æ–≤–∏—Ç—å main.pot –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤
   # –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –≤ ru.po
   # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å ru.mo –∏–∑ ru.po
   ```

**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**

–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ —É–∂–µ —Å–æ–∑–¥–∞–Ω: `find-hardcoded-strings.sh`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç
./find-hardcoded-strings.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—á–µ—Ç
cat hardcoded-strings-report.txt

# –î–ª—è –∫–∞–∂–¥–æ–π –Ω–∞–π–¥–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –æ–±–µ—Ä–Ω—É—Ç—å –≤ __()
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üî¥ **–ö–†–ò–¢–ò–ß–ù–û** - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∏–∑ frappe/main –Ω–∞ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
2. üî¥ **–ö–†–ò–¢–ò–ß–ù–û** - –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—à—É –≤–µ—Ä—Å–∏—é `ru.csv` (457 —Å—Ç—Ä–æ–∫ - –±–æ–ª–µ–µ –ø–æ–ª–Ω–∞—è!)
3. üî¥ **–ö–†–ò–¢–ò–ß–ù–û** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—à—É –≤–µ—Ä—Å–∏—é `ru.po` (–±–æ–ª–µ–µ –ø–æ–ª–Ω–∞—è)
4. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç `./find-hardcoded-strings.sh` –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–±–ª–µ–º
5. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫ –∏–∑ frappe/main
6. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞

**–í–∞–∂–Ω–æ:** –í frappe/main —á–∞—Å—Ç–æ –æ—Å—Ç–∞–≤–ª—è—é—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞!

---

#### 6.6. üü¢ –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞:

**–î–µ–π—Å—Ç–≤–∏—è:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –Ω–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ API –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
grep -r "crm.api.avito\|crm.api.performance\|crm.api.system\|crm.api.communication" \
  frontend/src --include="*.vue" --include="*.js"

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –±–∏—Ç—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
cd frontend
yarn build 2>&1 | grep -i "error\|cannot find\|module not found"

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å TypeScript/ESLint –æ—à–∏–±–∫–∏
yarn lint 2>&1 | head -50
```

---

#### 6.7. üü¢ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –º–µ—Ä–∂–∞ –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:

1. **–û–±–Ω–æ–≤–∏—Ç—å `.cursor/rules/frappe-crm-rules.mdc`**
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø—Ä–∞–≤–∏–ª–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã
   - –î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫–∏ –æ –Ω–æ–≤—ã—Ö –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

2. **–°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å CHANGELOG.md**
   - –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞
   - –£–∫–∞–∑–∞—Ç—å —á—Ç–æ –±—ã–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∏–∑ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ
   - –£–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ frappe/main

3. **–û–±–Ω–æ–≤–∏—Ç—å README.md (–µ—Å–ª–∏ –µ—Å—Ç—å)**
   - –£–∫–∞–∑–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
   - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞–∑–ª–∏—á–∏—è—Ö —Å –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–º

**–î–µ–π—Å—Ç–≤–∏—è:**
```bash
# –°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π
cat > CHANGELOG.md <<EOF
# Changelog –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞ —Å frappe/main

## –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∏–∑ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ñ–æ—Ä–∫–∞:
- Avito –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- –ö–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (permissions.py)
- API —Ñ–∞–π–ª—ã (performance, system, communication, etc.)
- DocTypes (CRM Funnel, Sales Funnel reports)
- Redis warmup –ª–æ–≥–∏–∫–∞ –≤ App.vue

## –î–æ–±–∞–≤–ª–µ–Ω–æ –∏–∑ frappe/main:
- Facebook Lead Forms –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- CRM Rolling Response Time
- –ù–æ–≤—ã–π ConditionsFilter –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –ù–æ–≤—ã–µ scheduler events –¥–ª—è lead syncing
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ bugfix –∏ —É–ª—É—á—à–µ–Ω–∏–π

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
- –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞ (InviteUserPage, ChangePasswordModal)
EOF
```

---

#### 6.7. üü¢ –ö–æ–º–º–∏—Ç –¥–æ—Ä–∞–±–æ—Ç–æ–∫

–ü–æ—Å–ª–µ –≤—Å–µ—Ö –¥–æ—Ä–∞–±–æ—Ç–æ–∫ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
git status

# 2. –î–æ–±–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add frontend/src/components/Settings/InviteUserPage.vue
git add frontend/src/components/Modals/ChangePasswordModal.vue
git add CHANGELOG.md
# ... –¥—Ä—É–≥–∏–µ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

# 3. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å
git commit -m "chore: fix onboarding inconsistencies and finalize merge

- Fix InviteUserPage to use custom onboarding
- Fix ChangePasswordModal to use custom onboarding
- Update documentation (CHANGELOG.md)
- Final checks and improvements"

# 4. –ï—Å–ª–∏ –≤—Å—ë –≥–æ—Ç–æ–≤–æ - —Å–º–µ—Ä–∂–∏—Ç—å –≤ develop
git checkout develop
git merge merge-frappe-main
```

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –î–û–†–ê–ë–û–¢–û–ö –ü–û–°–õ–ï –ú–ï–†–ñ–ê

### –û–Ω–±–æ–∞—Ä–¥–∏–Ω–≥
- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞ –≤ `InviteUserPage.vue`
- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥–∞ –≤ `ChangePasswordModal.vue`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `frappe-ui/frappe`

### –ü–µ—Ä–µ–≤–æ–¥—ã (–ö–†–ò–¢–ò–ß–ù–û!)
- [ ] **üî¥ –ö–†–ò–¢–ò–ß–ù–û:** –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–∞—à–∏ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (`ru.csv`, `ru.po` - –æ–Ω–∏ –±–æ–ª–µ–µ –ø–æ–ª–Ω—ã–µ!)
- [ ] **üî¥ –ö–†–ò–¢–ò–ß–ù–û:** –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç `./find-hardcoded-strings.sh` –¥–ª—è –ø–æ–∏—Å–∫–∞ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫
- [ ] **üî¥ –ö–†–ò–¢–ò–ß–ù–û:** –ù–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–∞—Ö –∏–∑ frappe/main
- [ ] **üî¥ –ö–†–ò–¢–ò–ß–ù–û:** –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫ –∏–∑ frappe/main –≤ `ru.csv` –∏ `ru.po`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —Å—Ç–∞—Ç—É—Å–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã (`*Translations.js`)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–ª–µ `sales_funnel` —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ `crm_deal.json`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (–Ω–µ—Ç –±–∏—Ç—ã—Ö —Å—Å—ã–ª–æ–∫)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ frappe/main

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (CHANGELOG, README)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `.cursor/rules` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

### –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- [ ] –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –≤—Å–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- [ ] –°–º–µ—Ä–∂–∏—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω—É—é –≤–µ—Ç–∫—É `develop`

---

**–í—Ä–µ–º—è –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–∏:** ~2-3 —á–∞—Å–∞ (—Å —É—á–µ—Ç–æ–º –ø–µ—Ä–µ–≤–æ–¥–æ–≤)  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π-–í—ã—Å–æ–∫–∏–π (–ø–µ—Ä–µ–≤–æ–¥—ã –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏!)

---

## üõ†Ô∏è –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–ô –ü–û–î–•–û–î: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ .gitattributes

–ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å `.gitattributes` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:

```bash
# .gitattributes
crm/api/avito.py merge=ours
crm/permissions.py merge=ours
crm/api/performance.py merge=ours
crm/api/system.py merge=ours
# ... –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ A

# –ó–∞—Ç–µ–º –ø—Ä–∏ –º–µ—Ä–∂–µ:
git merge -X ours frappe/main
```

**–ù–æ —ç—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –º–µ–Ω–µ–µ –≥–∏–±–∫–∏–π** - –ª—É—á—à–µ –¥–µ–ª–∞—Ç—å –≤—Ä—É—á–Ω—É—é –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.

---

## ‚úÖ –ò–¢–û–ì–û–í–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:** –°–æ–∑–¥–∞—Ç—å backup –≤—Å–µ—Ö –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (–≤–∫–ª—é—á–∞—è –ø–µ—Ä–µ–≤–æ–¥—ã!)
2. **–ú–µ—Ä–∂:** –í—ã–ø–æ–ª–Ω–∏—Ç—å `git merge frappe/main`
3. **–ö–∞—Ç–µ–≥–æ—Ä–∏—è A:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
4. **–ö–∞—Ç–µ–≥–æ—Ä–∏—è B:** –í—Ä—É—á–Ω—É—é –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–∞—à–∏ + –∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è
5. **–ö–∞—Ç–µ–≥–æ—Ä–∏—è C:** –ü—Ä–∏–Ω—è—Ç—å –∏—Ö + –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—à–∏ –º–µ—Å—Ç–∞
6. **–ö–∞—Ç–µ–≥–æ—Ä–∏—è D:** **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–∞—à–∏ –ø–µ—Ä–µ–≤–æ–¥—ã** (ru.csv, ru.po) + –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫
7. **–ö–∞—Ç–µ–≥–æ—Ä–∏—è E:** –ü—Ä–∏–Ω—è—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
8. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–≤–∫–ª—é—á–∞—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ —Ä—É—Å—Å–∫–æ–º!)
9. **–ö–æ–º–º–∏—Ç:** –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–µ—Ä–∂–∞
10. **–î–æ—Ä–∞–±–æ—Ç–∫–∏:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏, –ø–µ—Ä–µ–≤–æ–¥—ã –∏ —É–ª—É—á—à–∏—Ç—å —Ñ–æ—Ä–∫ (—Å–º. –≠–¢–ê–ü 6)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥
- ‚úÖ –ú–µ–Ω—å—à–µ —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã (–º–Ω–æ–≥–∏–µ —Ñ–∞–π–ª—ã –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- ‚úÖ –ß–µ—Ç–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —á—Ç–æ –¥–µ–ª–∞—Ç—å —Å –∫–∞–∂–¥—ã–º —Ñ–∞–π–ª–æ–º
- ‚úÖ –ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø–æ—ç—Ç–∞–ø–Ω–æ
- ‚úÖ –§–∏–Ω–∞–ª—å–Ω–∞—è —à–ª–∏—Ñ–æ–≤–∫–∞ –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–∫–∞

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î –ú–ï–†–ñ–ï–ú

- [ ] –°–æ–∑–¥–∞–Ω backup —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ Avito —Ñ–∞–π–ª—ã
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω –∫–∞—Å—Ç–æ–º–Ω—ã–π –æ–Ω–±–æ–∞—Ä–¥–∏–Ω–≥
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω —Å—Ç–∞—Ç—É—Å git (–Ω–µ—Ç –Ω–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- [ ] –ò–∑—É—á–µ–Ω—ã –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–º–∏—Ç—ã –≤ frappe/main
- [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –ø–ª–∞–Ω —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∫–æ–º–∞–Ω–¥—ã

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –ò –†–ï–°–£–†–°–´

- **–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/frappe/crm
- **Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/metalmon/crm
- **Remote frappe:** `frappe` ‚Üí https://github.com/frappe/crm.git
- **Remote upstream:** `upstream` ‚Üí https://github.com/metalmon/crm.git

---

**–ê–≤—Ç–æ—Ä –æ—Ç—á–µ—Ç–∞:** AI Assistant  
**–í–µ—Ä—Å–∏—è –æ—Ç—á–µ—Ç–∞:** 1.0  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-XX

